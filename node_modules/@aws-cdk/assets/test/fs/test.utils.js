"use strict";
const fs = require("fs");
const os = require("os");
const path = require("path");
const ts_mock_imports_1 = require("ts-mock-imports");
const fs_1 = require("../../lib/fs");
const util = require("../../lib/fs/utils");
const fs_utils_1 = require("./fs-utils");
const testShouldExclude = (test, pattern, expectExclude, expectInclude, shouldExcludeMethod) => {
    for (const exclude of expectExclude) {
        test.ok(shouldExcludeMethod(pattern, exclude), `${exclude} should have been excluded, but wasn't`);
    }
    for (const include of expectInclude) {
        test.ok(!shouldExcludeMethod(pattern, include), `${include} should have been included, but wasn't`);
    }
};
const testShouldExcludeDeep = (test, pattern, expectExclude, expectInclude) => testShouldExclude(test, pattern, expectExclude, expectInclude, (patterns, _path) => {
    const excludeRules = new util.ExcludeRules(patterns);
    return excludeRules.excludeFile(_path);
});
const testShouldExcludeDirectory = (test, pattern, expectExclude, expectInclude) => testShouldExclude(test, pattern, expectExclude, expectInclude, (patterns, _path) => {
    const excludeRules = new util.ExcludeRules(patterns);
    return excludeRules.excludeDirectory(_path);
});
module.exports = {
    shouldExclude: {
        'excludes nothing by default'(test) {
            test.ok(!util.shouldExclude([], path.join('some', 'file', 'path')));
            test.done();
        },
        'excludes requested files'(test) {
            const exclusions = ['*.ignored'];
            test.ok(util.shouldExclude(exclusions, path.join('some', 'file.ignored')));
            test.ok(!util.shouldExclude(exclusions, path.join('some', 'important', 'file')));
            test.done();
        },
        'does not exclude whitelisted files'(test) {
            const exclusions = ['*.ignored', '!important.*'];
            test.ok(!util.shouldExclude(exclusions, path.join('some', 'important.ignored')));
            test.done();
        },
    },
    shouldFollow: {
        always: {
            'follows internal'(test) {
                const sourceRoot = path.join('source', 'root');
                const linkTarget = path.join(sourceRoot, 'referent');
                const mockFsExists = ts_mock_imports_1.ImportMock.mockFunction(fs, 'existsSync', true);
                try {
                    test.ok(util.shouldFollow(fs_1.FollowMode.ALWAYS, sourceRoot, linkTarget));
                    test.ok(mockFsExists.calledOnceWith(linkTarget));
                    test.done();
                }
                finally {
                    mockFsExists.restore();
                }
            },
            'follows external'(test) {
                const sourceRoot = path.join('source', 'root');
                const linkTarget = path.join('alternate', 'referent');
                const mockFsExists = ts_mock_imports_1.ImportMock.mockFunction(fs, 'existsSync', true);
                try {
                    test.ok(util.shouldFollow(fs_1.FollowMode.ALWAYS, sourceRoot, linkTarget));
                    test.ok(mockFsExists.calledOnceWith(linkTarget));
                    test.done();
                }
                finally {
                    mockFsExists.restore();
                }
            },
            'does not follow internal when the referent does not exist'(test) {
                const sourceRoot = path.join('source', 'root');
                const linkTarget = path.join(sourceRoot, 'referent');
                const mockFsExists = ts_mock_imports_1.ImportMock.mockFunction(fs, 'existsSync', false);
                try {
                    test.ok(!util.shouldFollow(fs_1.FollowMode.ALWAYS, sourceRoot, linkTarget));
                    test.ok(mockFsExists.calledOnceWith(linkTarget));
                    test.done();
                }
                finally {
                    mockFsExists.restore();
                }
            },
            'does not follow external when the referent does not exist'(test) {
                const sourceRoot = path.join('source', 'root');
                const linkTarget = path.join('alternate', 'referent');
                const mockFsExists = ts_mock_imports_1.ImportMock.mockFunction(fs, 'existsSync', false);
                try {
                    test.ok(!util.shouldFollow(fs_1.FollowMode.ALWAYS, sourceRoot, linkTarget));
                    test.ok(mockFsExists.calledOnceWith(linkTarget));
                    test.done();
                }
                finally {
                    mockFsExists.restore();
                }
            },
        },
        external: {
            'does not follow internal'(test) {
                const sourceRoot = path.join('source', 'root');
                const linkTarget = path.join(sourceRoot, 'referent');
                const mockFsExists = ts_mock_imports_1.ImportMock.mockFunction(fs, 'existsSync');
                try {
                    test.ok(!util.shouldFollow(fs_1.FollowMode.EXTERNAL, sourceRoot, linkTarget));
                    test.ok(mockFsExists.notCalled);
                    test.done();
                }
                finally {
                    mockFsExists.restore();
                }
            },
            'follows external'(test) {
                const sourceRoot = path.join('source', 'root');
                const linkTarget = path.join('alternate', 'referent');
                const mockFsExists = ts_mock_imports_1.ImportMock.mockFunction(fs, 'existsSync', true);
                try {
                    test.ok(util.shouldFollow(fs_1.FollowMode.EXTERNAL, sourceRoot, linkTarget));
                    test.ok(mockFsExists.calledOnceWith(linkTarget));
                    test.done();
                }
                finally {
                    mockFsExists.restore();
                }
            },
            'does not follow external when referent does not exist'(test) {
                const sourceRoot = path.join('source', 'root');
                const linkTarget = path.join('alternate', 'referent');
                const mockFsExists = ts_mock_imports_1.ImportMock.mockFunction(fs, 'existsSync', false);
                try {
                    test.ok(!util.shouldFollow(fs_1.FollowMode.EXTERNAL, sourceRoot, linkTarget));
                    test.ok(mockFsExists.calledOnceWith(linkTarget));
                    test.done();
                }
                finally {
                    mockFsExists.restore();
                }
            },
        },
        blockExternal: {
            'follows internal'(test) {
                const sourceRoot = path.join('source', 'root');
                const linkTarget = path.join(sourceRoot, 'referent');
                const mockFsExists = ts_mock_imports_1.ImportMock.mockFunction(fs, 'existsSync', true);
                try {
                    test.ok(util.shouldFollow(fs_1.FollowMode.BLOCK_EXTERNAL, sourceRoot, linkTarget));
                    test.ok(mockFsExists.calledOnceWith(linkTarget));
                    test.done();
                }
                finally {
                    mockFsExists.restore();
                }
            },
            'does not follow internal when referent does not exist'(test) {
                const sourceRoot = path.join('source', 'root');
                const linkTarget = path.join(sourceRoot, 'referent');
                const mockFsExists = ts_mock_imports_1.ImportMock.mockFunction(fs, 'existsSync', false);
                try {
                    test.ok(!util.shouldFollow(fs_1.FollowMode.BLOCK_EXTERNAL, sourceRoot, linkTarget));
                    test.ok(mockFsExists.calledOnceWith(linkTarget));
                    test.done();
                }
                finally {
                    mockFsExists.restore();
                }
            },
            'does not follow external'(test) {
                const sourceRoot = path.join('source', 'root');
                const linkTarget = path.join('alternate', 'referent');
                const mockFsExists = ts_mock_imports_1.ImportMock.mockFunction(fs, 'existsSync');
                try {
                    test.ok(!util.shouldFollow(fs_1.FollowMode.BLOCK_EXTERNAL, sourceRoot, linkTarget));
                    test.ok(mockFsExists.notCalled);
                    test.done();
                }
                finally {
                    mockFsExists.restore();
                }
            },
        },
        never: {
            'does not follow internal'(test) {
                const sourceRoot = path.join('source', 'root');
                const linkTarget = path.join(sourceRoot, 'referent');
                const mockFsExists = ts_mock_imports_1.ImportMock.mockFunction(fs, 'existsSync');
                try {
                    test.ok(!util.shouldFollow(fs_1.FollowMode.NEVER, sourceRoot, linkTarget));
                    test.ok(mockFsExists.notCalled);
                    test.done();
                }
                finally {
                    mockFsExists.restore();
                }
            },
            'does not follow external'(test) {
                const sourceRoot = path.join('source', 'root');
                const linkTarget = path.join('alternate', 'referent');
                const mockFsExists = ts_mock_imports_1.ImportMock.mockFunction(fs, 'existsSync');
                try {
                    test.ok(!util.shouldFollow(fs_1.FollowMode.NEVER, sourceRoot, linkTarget));
                    test.ok(mockFsExists.notCalled);
                    test.done();
                }
                finally {
                    mockFsExists.restore();
                }
            },
        }
    },
    shouldExcludeDeep: {
        'without pattern'(test) {
            testShouldExcludeDeep(test, [], [], ['foo.txt']);
            testShouldExcludeDeep(test, [''], [], ['foo.txt']);
            testShouldExcludeDeep(test, ['# comment'], [], ['foo.txt']);
            test.done();
        },
        'basic usage'(test) {
            testShouldExcludeDeep(test, ['foo.txt'], [
                'foo.txt',
                'foo.txt/file',
                'dir/foo.txt',
            ], [
                'bar.txt',
                'foo',
                'foo.txt.old',
            ]);
            test.done();
        },
        'negative contridactory'(test) {
            testShouldExcludeDeep(test, ['foo.txt', '!foo.txt'], [], ['foo.txt']);
            test.done();
        },
        'positive contridactory'(test) {
            testShouldExcludeDeep(test, ['!foo.txt', 'foo.txt'], ['foo.txt'], []);
            test.done();
        },
        'dir single wildcard'(test) {
            testShouldExcludeDeep(test, ['d?r'], [
                'dir',
                'dir/exclude',
                'dir/exclude/file',
            ], [
                'door',
                'door/file',
            ]);
            test.done();
        },
        'dir wildcard'(test) {
            testShouldExcludeDeep(test, ['d*r'], [
                'dir',
                'dir/file',
                'door',
                'door/file',
            ], [
                'dog',
                'dog/file',
            ]);
            test.done();
        },
        'dir deep wildcard'(test) {
            testShouldExcludeDeep(test, ['dir/**/*', '!dir/include/**/*'], [
                'dir/deep',
                'dir/deep/file',
                'dir/deep/deeper/file',
                'dir/include',
            ], [
                'dir',
                'dir/include/deep',
                'dir/include/deep/deeper',
            ]);
            test.done();
        },
        'deep structure'(test) {
            testShouldExcludeDeep(test, ['deep/exclude'], [
                'deep/exclude',
                'deep/exclude/file',
            ], [
                'deep',
                'deep/include',
                'deep/include/file',
            ]);
            test.done();
        },
        'inverted pattern'(test) {
            testShouldExcludeDeep(test, ['*', '!foo.txt', '!d?r', 'dir/exclude'], [
                'bar.txt',
                'dir/exclude',
                'dir/exclude/file',
            ], [
                '.hidden-file',
                'foo.txt',
                'dir',
                'dir/include',
                'dir/include/subdir',
                'exclude/foo.txt',
            ]);
            test.done();
        },
    },
    shouldExcludeDirectory: {
        'without pattern'(test) {
            testShouldExcludeDirectory(test, [], [], ['dir']);
            testShouldExcludeDirectory(test, [''], [], ['dir']);
            testShouldExcludeDirectory(test, ['# comment'], [], ['dir']);
            test.done();
        },
        'basic usage'(test) {
            const pattern = ['dir', '!dir/*', 'other_dir'];
            testShouldExcludeDeep(test, pattern, ['dir', 'other_dir'], ['dir/file']);
            testShouldExcludeDirectory(test, pattern, ['dir/deep', 'other_dir'], ['dir']);
            test.done();
        },
        'deep structure'(test) {
            const pattern = ['dir', '!dir/subdir/?', 'other_dir', 'really/deep/structure/of/files/and/dirs'];
            testShouldExcludeDeep(test, pattern, ['dir', 'dir/subdir', 'other_dir'], ['dir/subdir/a']);
            testShouldExcludeDirectory(test, pattern, ['other_dir', 'dir/subdir/d'], ['dir', 'dir/subdir']);
            test.done();
        },
        'wildcard pattern'(test) {
            const pattern = ['dir', '!dir/*/*', 'other_dir'];
            testShouldExcludeDeep(test, pattern, ['dir', 'other_dir', 'dir/file'], ['dir/file/deep']);
            testShouldExcludeDirectory(test, pattern, ['other_dir', 'dir/deep/struct'], ['dir', 'dir/deep', 'dir/deep']);
            test.done();
        },
        'deep wildcard'(test) {
            const pattern = ['dir', '!dir/**/*', 'other_dir'];
            testShouldExcludeDeep(test, pattern, ['dir', 'other_dir'], ['dir/file', 'dir/file/deep']);
            testShouldExcludeDirectory(test, pattern, ['other_dir'], ['dir', 'dir/deep', 'dir/deep/struct', 'dir/really/really/really/really/deep']);
            test.done();
        },
    },
    listFilesRecursively: {
        'basic usage'(test) {
            const exclude = [''];
            const follow = fs_1.FollowMode.ALWAYS;
            const tree = `
      ├── directory
      │   ├── foo.txt
      │   └── bar.txt
      ├── empty-dir (D)
      ├── deep
      │   ├── dir
      │   │   └── struct
      │   │       └── qux.txt
      ├── foobar.txt`;
            const { directory, cleanup } = fs_utils_1.FsUtils.fromTree('basic', tree);
            const paths = util.listFilesRecursively(directory, { exclude, follow }).map(({ relativePath }) => relativePath);
            test.deepEqual(paths, [
                'deep/dir/struct/qux.txt',
                'directory/bar.txt',
                'directory/foo.txt',
                'empty-dir',
                'foobar.txt',
            ]);
            cleanup();
            test.done();
        },
        'exclude'(test) {
            const exclude = ['foobar.txt', 'deep', '!deep/foo.txt'];
            const follow = fs_1.FollowMode.ALWAYS;
            const tree = `
      ├── directory
      │   ├── foo.txt
      │   └── bar.txt
      ├── deep
      │   ├── dir
      │   │   └── struct
      │   │       └── qux.txt
      │   ├── foo.txt
      │   └── bar.txt
      ├── foobar.txt`;
            const { directory, cleanup } = fs_utils_1.FsUtils.fromTree('exclude', tree);
            const paths = util.listFilesRecursively(directory, { exclude, follow }).map(({ relativePath }) => relativePath);
            test.deepEqual(paths, [
                'deep/foo.txt',
                'directory/bar.txt',
                'directory/foo.txt',
            ]);
            cleanup();
            test.done();
        },
        'symlinks': {
            'without exclusion'(test) {
                const exclude = [''];
                const externalTree = fs_utils_1.FsUtils.fromTree('exclude', `
          ├── external_dir
          │   ├── foobar.txt`);
                const internalTree = fs_utils_1.FsUtils.fromTree('exclude', `
          ├── directory
          │   ├── foo.txt
          ├── internal_link -> directory
          ├── external_link -> ../${path.relative(os.tmpdir(), externalTree.directory)}/external_dir`);
                const expected = {
                    [fs_1.FollowMode.NEVER]: [
                        'directory/foo.txt',
                        'external_link',
                        'internal_link',
                    ],
                    [fs_1.FollowMode.ALWAYS]: [
                        'directory/foo.txt',
                        'external_link/foobar.txt',
                        'internal_link/foo.txt',
                    ],
                    [fs_1.FollowMode.EXTERNAL]: [
                        'directory/foo.txt',
                        'external_link/foobar.txt',
                        'internal_link'
                    ],
                    [fs_1.FollowMode.BLOCK_EXTERNAL]: [
                        'directory/foo.txt',
                        'external_link',
                        'internal_link/foo.txt',
                    ],
                };
                for (const follow of Object.values(fs_1.FollowMode)) {
                    const paths = util.listFilesRecursively(internalTree.directory, { exclude, follow }).map(({ relativePath }) => relativePath);
                    test.deepEqual(paths, expected[follow], follow);
                }
                internalTree.cleanup();
                externalTree.cleanup();
                test.done();
            },
        },
        'exclude targets'(test) {
            const exclude = ['external_dir', 'directory'];
            const follow = fs_1.FollowMode.ALWAYS;
            const externalTree = fs_utils_1.FsUtils.fromTree('exclude', `
        ├── external_dir
        │   ├── foobar.txt`);
            const internalTree = fs_utils_1.FsUtils.fromTree('exclude', `
        ├── directory
        │   ├── foo.txt
        ├── internal_link -> directory
        ├── external_link -> ../${path.relative(os.tmpdir(), externalTree.directory)}/external_dir`);
            const paths = util.listFilesRecursively(internalTree.directory, { exclude, follow }).map(({ relativePath }) => relativePath);
            test.deepEqual(paths, [
                'external_link/foobar.txt',
                'internal_link/foo.txt'
            ]);
            internalTree.cleanup();
            externalTree.cleanup();
            test.done();
        },
        'exclude links'(test) {
            const exclude = ['internal_link', 'external_link'];
            const follow = fs_1.FollowMode.ALWAYS;
            const externalTree = fs_utils_1.FsUtils.fromTree('exclude', `
        ├── external_dir
        │   ├── foobar.txt`);
            const internalTree = fs_utils_1.FsUtils.fromTree('exclude', `
        ├── directory
        │   ├── foo.txt
        ├── internal_link -> directory
        ├── external_link -> ../${path.relative(os.tmpdir(), externalTree.directory)}/external_dir`);
            const paths = util.listFilesRecursively(internalTree.directory, { exclude, follow }).map(({ relativePath }) => relativePath);
            test.deepEqual(paths, [
                'directory/foo.txt'
            ]);
            internalTree.cleanup();
            externalTree.cleanup();
            test.done();
        },
    },
};
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoidGVzdC51dGlscy5qcyIsInNvdXJjZVJvb3QiOiIiLCJzb3VyY2VzIjpbInRlc3QudXRpbHMudHMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IjtBQUFBLHlCQUEwQjtBQUUxQix5QkFBMEI7QUFDMUIsNkJBQThCO0FBQzlCLHFEQUE2QztBQUM3QyxxQ0FBMEM7QUFDMUMsMkNBQTRDO0FBQzVDLHlDQUFxQztBQXFmckMsTUFBTSxpQkFBaUIsR0FBRyxDQUN4QixJQUFVLEVBQ1YsT0FBaUIsRUFDakIsYUFBdUIsRUFDdkIsYUFBdUIsRUFDdkIsbUJBQWlFLEVBQUUsRUFBRTtJQUNyRSxLQUFLLE1BQU0sT0FBTyxJQUFJLGFBQWEsRUFBRTtRQUNuQyxJQUFJLENBQUMsRUFBRSxDQUFDLG1CQUFtQixDQUFDLE9BQU8sRUFBRSxPQUFPLENBQUMsRUFBRSxHQUFHLE9BQU8sd0NBQXdDLENBQUMsQ0FBQztLQUNwRztJQUNELEtBQUssTUFBTSxPQUFPLElBQUksYUFBYSxFQUFFO1FBQ25DLElBQUksQ0FBQyxFQUFFLENBQUMsQ0FBQyxtQkFBbUIsQ0FBQyxPQUFPLEVBQUUsT0FBTyxDQUFDLEVBQUUsR0FBRyxPQUFPLHdDQUF3QyxDQUFDLENBQUM7S0FDckc7QUFDSCxDQUFDLENBQUM7QUFFRixNQUFNLHFCQUFxQixHQUFHLENBQUMsSUFBVSxFQUFFLE9BQWlCLEVBQUUsYUFBdUIsRUFBRSxhQUF1QixFQUFFLEVBQUUsQ0FDaEgsaUJBQWlCLENBQUMsSUFBSSxFQUFFLE9BQU8sRUFBRSxhQUFhLEVBQUUsYUFBYSxFQUFFLENBQUMsUUFBa0IsRUFBRSxLQUFhLEVBQUUsRUFBRTtJQUNuRyxNQUFNLFlBQVksR0FBRyxJQUFJLElBQUksQ0FBQyxZQUFZLENBQUMsUUFBUSxDQUFDLENBQUM7SUFDckQsT0FBTyxZQUFZLENBQUMsV0FBVyxDQUFDLEtBQUssQ0FBQyxDQUFDO0FBQ3pDLENBQUMsQ0FBQyxDQUFDO0FBRUwsTUFBTSwwQkFBMEIsR0FBRyxDQUFDLElBQVUsRUFBRSxP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LFlBQVksQ0FBQyxPQUFPLEVBQUUsQ0FBQztZQUN2QixJQUFJLENBQUMsSUFBSSxFQUFFLENBQUM7UUFDZCxDQUFDO1FBQ0QsZUFBZSxDQUFDLElBQVU7WUFDeEIsTUFBTSxPQUFPLEdBQUcsQ0FBQyxlQUFlLEVBQUUsZUFBZSxDQUFDLENBQUM7WUFDbkQsTUFBTSxNQUFNLEdBQUcsZUFBVSxDQUFDLE1BQU0sQ0FBQztZQUNqQyxNQUFNLFlBQVksR0FBRyxrQkFBTyxDQUFDLFFBQVEsQ0FBQyxTQUFTLEVBQUU7OzJCQUU1QixDQUFDLENBQUM7WUFFdkIsTUFBTSxZQUFZLEdBQUcsa0JBQU8sQ0FBQyxRQUFRLENBQUMsU0FBUyxFQUFFOzs7O2tDQUlyQixJQUFJLENBQUMsUUFBUSxDQUFDLEVBQUUsQ0FBQyxNQUFNLEVBQUUsRUFBRSxZQUFZLENBQUMsU0FBUyxDQUFDLGVBQWUsQ0FBQyxDQUFDO1lBQy9GLE1BQU0sS0FBSyxHQUFHLElBQUksQ0FBQyxvQkFBb0IsQ0FBQyxZQUFZLENBQUMsU0FBUyxFQUFFLEVBQUUsT0FBTyxFQUFFLE1BQU0sRUFBRSxDQUFDLENBQUMsR0FBRyxDQUFDLENBQUMsRUFBRSxZQUFZLEVBQUUsRUFBRSxFQUFFLENBQUMsWUFBWSxDQUFDLENBQUM7WUFFN0gsSUFBSSxDQUFDLFNBQVMsQ0FBQyxLQUFLLEVBQUU7Z0JBQ3BCLG1CQUFtQjthQUNwQixDQUFDLENBQUM7WUFFSCxZQUFZLENBQUMsT0FBTyxFQUFFLENBQUM7WUFDdkIsWUFBWSxDQUFDLE9BQU8sRUFBRSxDQUFDO1lBQ3ZCLElBQUksQ0FBQyxJQUFJLEVBQUUsQ0FBQztRQUNkLENBQUM7S0FDRjtDQUNGLENBQUMiLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgZnMgPSByZXF1aXJlKCdmcycpO1xuaW1wb3J0IHsgVGVzdCB9IGZyb20gJ25vZGV1bml0JztcbmltcG9ydCBvcyA9IHJlcXVpcmUoJ29zJyk7XG5pbXBvcnQgcGF0aCA9IHJlcXVpcmUoJ3BhdGgnKTtcbmltcG9ydCB7IEltcG9ydE1vY2sgfSBmcm9tICd0cy1tb2NrLWltcG9ydHMnO1xuaW1wb3J0IHsgRm9sbG93TW9kZSB9IGZyb20gJy4uLy4uL2xpYi9mcyc7XG5pbXBvcnQgdXRpbCA9IHJlcXVpcmUoJy4uLy4uL2xpYi9mcy91dGlscycpO1xuaW1wb3J0IHsgRnNVdGlscyB9IGZyb20gJy4vZnMtdXRpbHMnO1xuXG5leHBvcnQgPSB7XG4gIHNob3VsZEV4Y2x1ZGU6IHtcbiAgICAnZXhjbHVkZXMgbm90aGluZyBieSBkZWZhdWx0Jyh0ZXN0OiBUZXN0KSB7XG4gICAgICB0ZXN0Lm9rKCF1dGlsLnNob3VsZEV4Y2x1ZGUoW10sIHBhdGguam9pbignc29tZScsICdmaWxlJywgJ3BhdGgnKSkpO1xuICAgICAgdGVzdC5kb25lKCk7XG4gICAgfSxcblxuICAgICdleGNsdWRlcyByZXF1ZXN0ZWQgZmlsZXMnKHRlc3Q6IFRlc3QpIHtcbiAgICAgIGNvbnN0IGV4Y2x1c2lvbnMgPSBbJyouaWdub3JlZCddO1xuICAgICAgdGVzdC5vayh1dGlsLnNob3VsZEV4Y2x1ZGUoZXhjbHVzaW9ucywgcGF0aC5qb2luKCdzb21lJywgJ2ZpbGUuaWdub3JlZCcpKSk7XG4gICAgICB0ZXN0Lm9rKCF1dGlsLnNob3VsZEV4Y2x1ZGUoZXhjbHVzaW9ucywgcGF0aC5qb2luKCdzb21lJywgJ2ltcG9ydGFudCcsICdmaWxlJykpKTtcbiAgICAgIHRlc3QuZG9uZSgpO1xuICAgIH0sXG5cbiAgICAnZG9lcyBub3QgZXhjbHVkZSB3aGl0ZWxpc3RlZCBmaWxlcycodGVzdDogVGVzdCkge1xuICAgICAgY29uc3QgZXhjbHVzaW9ucyA9IFsnKi5pZ25vcmVkJywgJyFpbXBvcnRhbnQuKiddO1xuICAgICAgdGVzdC5vayghdXRpbC5zaG91bGRFeGNsdWRlKGV4Y2x1c2lvbnMsIHBhdGguam9pbignc29tZScsICdpbXBvcnRhbnQuaWdub3JlZCcpKSk7XG4gICAgICB0ZXN0LmRvbmUoKTtcbiAgICB9LFxuICB9LFxuXG4gIHNob3VsZEZvbGxvdzoge1xuICAgIGFsd2F5czoge1xuICAgICAgJ2ZvbGxvd3MgaW50ZXJuYWwnKHRlc3Q6IFRlc3QpIHtcbiAgICAgICAgY29uc3Qgc291cmNlUm9vdCA9IHBhdGguam9pbignc291cmNlJywgJ3Jvb3QnKTtcbiAgICAgICAgY29uc3QgbGlua1RhcmdldCA9IHBhdGguam9pbihzb3VyY2VSb290LCAncmVmZXJlbnQnKTtcblxuICAgICAgICBjb25zdCBtb2NrRnNFeGlzdHMgPSBJbXBvcnRNb2NrLm1vY2tGdW5jdGlvbihmcywgJ2V4aXN0c1N5bmMnLCB0cnVlKTtcbiAgICAgICAgdHJ5IHtcbiAgICAgICAgICB0ZXN0Lm9rKHV0aWwuc2hvdWxkRm9sbG93KEZvbGxvd01vZGUuQUxXQVlTLCBzb3VyY2VSb290LCBsaW5rVGFyZ2V0KSk7XG4gICAgICAgICAgdGVzdC5vayhtb2NrRnNFeGlzdHMuY2FsbGVkT25jZVdpdGgobGlua1RhcmdldCkpO1xuICAgICAgICAgIHRlc3QuZG9uZSgpO1xuICAgICAgICB9IGZpbmFsbHkge1xuICAgICAgICAgIG1vY2tGc0V4aXN0cy5yZXN0b3JlKCk7XG4gICAgICAgIH1cbiAgICAgIH0sXG5cbiAgICAgICdmb2xsb3dzIGV4dGVybmFsJyh0ZXN0OiBUZXN0KSB7XG4gICAgICAgIGNvbnN0IHNvdXJjZVJvb3QgPSBwYXRoLmpvaW4oJ3NvdXJjZScsICdyb290Jyk7XG4gICAgICAgIGNvbnN0IGxpbmtUYXJnZXQgPSBwYXRoLmpvaW4oJ2FsdGVybmF0ZScsICdyZWZlcmVudCcpO1xuICAgICAgICBjb25zdCBtb2NrRnNFeGlzdHMgPSBJbXBvcnRNb2NrLm1vY2tGdW5jdGlvbihmcywgJ2V4aXN0c1N5bmMnLCB0cnVlKTtcbiAgICAgICAgdHJ5IHtcbiAgICAgICAgICB0ZXN0Lm9rKHV0aWwuc2hvdWxkRm9sbG93KEZvbGxvd01vZGUuQUxXQVlTLCBzb3VyY2VSb290LCBsaW5rVGFyZ2V0KSk7XG4gICAgICAgICAgdGVzdC5vayhtb2NrRnNFeGlzdHMuY2FsbGVkT25jZVdpdGgobGlua1RhcmdldCkpO1xuICAgICAgICAgIHRlc3QuZG9uZSgpO1xuICAgICAgICB9IGZpbmFsbHkge1xuICAgICAgICAgIG1vY2tGc0V4aXN0cy5yZXN0b3JlKCk7XG4gICAgICAgIH1cbiAgICAgIH0sXG5cbiAgICAgICdkb2VzIG5vdCBmb2xsb3cgaW50ZXJuYWwgd2hlbiB0aGUgcmVmZXJlbnQgZG9lcyBub3QgZXhpc3QnKHRlc3Q6IFRlc3QpIHtcbiAgICAgICAgY29uc3Qgc291cmNlUm9vdCA9IHBhdGguam9pbignc291cmNlJywgJ3Jvb3QnKTtcbiAgICAgICAgY29uc3QgbGlua1RhcmdldCA9IHBhdGguam9pbihzb3VyY2VSb290LCAncmVmZXJlbnQnKTtcbiAgICAgICAgY29uc3QgbW9ja0ZzRXhpc3RzID0gSW1wb3J0TW9jay5tb2NrRnVuY3Rpb24oZnMsICdleGlzdHNTeW5jJywgZmFsc2UpO1xuICAgICAgICB0cnkge1xuICAgICAgICAgIHRlc3Qub2soIXV0aWwuc2hvdWxkRm9sbG93KEZvbGxvd01vZGUuQUxXQVlTLCBzb3VyY2VSb290LCBsaW5rVGFyZ2V0KSk7XG4gICAgICAgICAgdGVzdC5vayhtb2NrRnNFeGlzdHMuY2FsbGVkT25jZVdpdGgobGlua1RhcmdldCkpO1xuICAgICAgICAgIHRlc3QuZG9uZSgpO1xuICAgICAgICB9IGZpbmFsbHkge1xuICAgICAgICAgIG1vY2tGc0V4aXN0cy5yZXN0b3JlKCk7XG4gICAgICAgIH1cbiAgICAgIH0sXG5cbiAgICAgICdkb2VzIG5vdCBmb2xsb3cgZXh0ZXJuYWwgd2hlbiB0aGUgcmVmZXJlbnQgZG9lcyBub3QgZXhpc3QnKHRlc3Q6IFRlc3QpIHtcbiAgICAgICAgY29uc3Qgc291cmNlUm9vdCA9IHBhdGguam9pbignc291cmNlJywgJ3Jvb3QnKTtcbiAgICAgICAgY29uc3QgbGlua1RhcmdldCA9IHBhdGguam9pbignYWx0ZXJuYXRlJywgJ3JlZmVyZW50Jyk7XG4gICAgICAgIGNvbnN0IG1vY2tGc0V4aXN0cyA9IEltcG9ydE1vY2subW9ja0Z1bmN0aW9uKGZzLCAnZXhpc3RzU3luYycsIGZhbHNlKTtcbiAgICAgICAgdHJ5IHtcbiAgICAgICAgICB0ZXN0Lm9rKCF1dGlsLnNob3VsZEZvbGxvdyhGb2xsb3dNb2RlLkFMV0FZUywgc291cmNlUm9vdCwgbGlua1RhcmdldCkpO1xuICAgICAgICAgIHRlc3Qub2sobW9ja0ZzRXhpc3RzLmNhbGxlZE9uY2VXaXRoKGxpbmtUYXJnZXQpKTtcbiAgICAgICAgICB0ZXN0LmRvbmUoKTtcbiAgICAgICAgfSBmaW5hbGx5IHtcbiAgICAgICAgICBtb2NrRnNFeGlzdHMucmVzdG9yZSgpO1xuICAgICAgICB9XG4gICAgICB9LFxuICAgIH0sXG5cbiAgICBleHRlcm5hbDoge1xuICAgICAgJ2RvZXMgbm90IGZvbGxvdyBpbnRlcm5hbCcodGVzdDogVGVzdCkge1xuICAgICAgICBjb25zdCBzb3VyY2VSb290ID0gcGF0aC5qb2luKCdzb3VyY2UnLCAncm9vdCcpO1xuICAgICAgICBjb25zdCBsaW5rVGFyZ2V0ID0gcGF0aC5qb2luKHNvdXJjZVJvb3QsICdyZWZlcmVudCcpO1xuICAgICAgICBjb25zdCBtb2NrRnNFeGlzdHMgPSBJbXBvcnRNb2NrLm1vY2tGdW5jdGlvbihmcywgJ2V4aXN0c1N5bmMnKTtcbiAgICAgICAgdHJ5IHtcbiAgICAgICAgICB0ZXN0Lm9rKCF1dGlsLnNob3VsZEZvbGxvdyhGb2xsb3dNb2RlLkVYVEVSTkFMLCBzb3VyY2VSb290LCBsaW5rVGFyZ2V0KSk7XG4gICAgICAgICAgdGVzdC5vayhtb2NrRnNFeGlzdHMubm90Q2FsbGVkKTtcbiAgICAgICAgICB0ZXN0LmRvbmUoKTtcbiAgICAgICAgfSBmaW5hbGx5IHtcbiAgICAgICAgICBtb2NrRnNFeGlzdHMucmVzdG9yZSgpO1xuICAgICAgICB9XG4gICAgICB9LFxuXG4gICAgICAnZm9sbG93cyBleHRlcm5hbCcodGVzdDogVGVzdCkge1xuICAgICAgICBjb25zdCBzb3VyY2VSb290ID0gcGF0aC5qb2luKCdzb3VyY2UnLCAncm9vdCcpO1xuICAgICAgICBjb25zdCBsaW5rVGFyZ2V0ID0gcGF0aC5qb2luKCdhbHRlcm5hdGUnLCAncmVmZXJlbnQnKTtcbiAgICAgICAgY29uc3QgbW9ja0ZzRXhpc3RzID0gSW1wb3J0TW9jay5tb2NrRnVuY3Rpb24oZnMsICdleGlzdHNTeW5jJywgdHJ1ZSk7XG4gICAgICAgIHRyeSB7XG4gICAgICAgICAgdGVzdC5vayh1dGlsLnNob3VsZEZvbGxvdyhGb2xsb3dNb2RlLkVYVEVSTkFMLCBzb3VyY2VSb290LCBsaW5rVGFyZ2V0KSk7XG4gICAgICAgICAgdGVzdC5vayhtb2NrRnNFeGlzdHMuY2FsbGVkT25jZVdpdGgobGlua1RhcmdldCkpO1xuICAgICAgICAgIHRlc3QuZG9uZSgpO1xuICAgICAgICB9IGZpbmFsbHkge1xuICAgICAgICAgIG1vY2tGc0V4aXN0cy5yZXN0b3JlKCk7XG4gICAgICAgIH1cbiAgICAgIH0sXG5cbiAgICAgICdkb2VzIG5vdCBmb2xsb3cgZXh0ZXJuYWwgd2hlbiByZWZlcmVudCBkb2VzIG5vdCBleGlzdCcodGVzdDogVGVzdCkge1xuICAgICAgICBjb25zdCBzb3VyY2VSb290ID0gcGF0aC5qb2luKCdzb3VyY2UnLCAncm9vdCcpO1xuICAgICAgICBjb25zdCBsaW5rVGFyZ2V0ID0gcGF0aC5qb2luKCdhbHRlcm5hdGUnLCAncmVmZXJlbnQnKTtcbiAgICAgICAgY29uc3QgbW9ja0ZzRXhpc3RzID0gSW1wb3J0TW9jay5tb2NrRnVuY3Rpb24oZnMsICdleGlzdHNTeW5jJywgZmFsc2UpO1xuICAgICAgICB0cnkge1xuICAgICAgICAgIHRlc3Qub2soIXV0aWwuc2hvdWxkRm9sbG93KEZvbGxvd01vZGUuRVhURVJOQUwsIHNvdXJjZVJvb3QsIGxpbmtUYXJnZXQpKTtcbiAgICAgICAgICB0ZXN0Lm9rKG1vY2tGc0V4aXN0cy5jYWxsZWRPbmNlV2l0aChsaW5rVGFyZ2V0KSk7XG4gICAgICAgICAgdGVzdC5kb25lKCk7XG4gICAgICAgIH0gZmluYWxseSB7XG4gICAgICAgICAgbW9ja0ZzRXhpc3RzLnJlc3RvcmUoKTtcbiAgICAgICAgfVxuICAgICAgfSxcbiAgICB9LFxuXG4gICAgYmxvY2tFeHRlcm5hbDoge1xuICAgICAgJ2ZvbGxvd3MgaW50ZXJuYWwnKHRlc3Q6IFRlc3QpIHtcbiAgICAgICAgY29uc3Qgc291cmNlUm9vdCA9IHBhdGguam9pbignc291cmNlJywgJ3Jvb3QnKTtcbiAgICAgICAgY29uc3QgbGlua1RhcmdldCA9IHBhdGguam9pbihzb3VyY2VSb290LCAncmVmZXJlbnQnKTtcbiAgICAgICAgY29uc3QgbW9ja0ZzRXhpc3RzID0gSW1wb3J0TW9jay5tb2NrRnVuY3Rpb24oZnMsICdleGlzdHNTeW5jJywgdHJ1ZSk7XG4gICAgICAgIHRyeSB7XG4gICAgICAgICAgdGVzdC5vayh1dGlsLnNob3VsZEZvbGxvdyhGb2xsb3dNb2RlLkJMT0NLX0VYVEVSTkFMLCBzb3VyY2VSb290LCBsaW5rVGFyZ2V0KSk7XG4gICAgICAgICAgdGVzdC5vayhtb2NrRnNFeGlzdHMuY2FsbGVkT25jZVdpdGgobGlua1RhcmdldCkpO1xuICAgICAgICAgIHRlc3QuZG9uZSgpO1xuICAgICAgICB9IGZpbmFsbHkge1xuICAgICAgICAgIG1vY2tGc0V4aXN0cy5yZXN0b3JlKCk7XG4gICAgICAgIH1cbiAgICAgIH0sXG5cbiAgICAgICdkb2VzIG5vdCBmb2xsb3cgaW50ZXJuYWwgd2hlbiByZWZlcmVudCBkb2VzIG5vdCBleGlzdCcodGVzdDogVGVzdCkge1xuICAgICAgICBjb25zdCBzb3VyY2VSb290ID0gcGF0aC5qb2luKCdzb3VyY2UnLCAncm9vdCcpO1xuICAgICAgICBjb25zdCBsaW5rVGFyZ2V0ID0gcGF0aC5qb2luKHNvdXJjZVJvb3QsICdyZWZlcmVudCcpO1xuICAgICAgICBjb25zdCBtb2NrRnNFeGlzdHMgPSBJbXBvcnRNb2NrLm1vY2tGdW5jdGlvbihmcywgJ2V4aXN0c1N5bmMnLCBmYWxzZSk7XG4gICAgICAgIHRyeSB7XG4gICAgICAgICAgdGVzdC5vayghdXRpbC5zaG91bGRGb2xsb3coRm9sbG93TW9kZS5CTE9DS19FWFRFUk5BTCwgc291cmNlUm9vdCwgbGlua1RhcmdldCkpO1xuICAgICAgICAgIHRlc3Qub2sobW9ja0ZzRXhpc3RzLmNhbGxlZE9uY2VXaXRoKGxpbmtUYXJnZXQpKTtcbiAgICAgICAgICB0ZXN0LmRvbmUoKTtcbiAgICAgICAgfSBmaW5hbGx5IHtcbiAgICAgICAgICBtb2NrRnNFeGlzdHMucmVzdG9yZSgpO1xuICAgICAgICB9XG4gICAgICB9LFxuXG4gICAgICAnZG9lcyBub3QgZm9sbG93IGV4dGVybmFsJyh0ZXN0OiBUZXN0KSB7XG4gICAgICAgIGNvbnN0IHNvdXJjZVJvb3QgPSBwYXRoLmpvaW4oJ3NvdXJjZScsICdyb290Jyk7XG4gICAgICAgIGNvbnN0IGxpbmtUYXJnZXQgPSBwYXRoLmpvaW4oJ2FsdGVybmF0ZScsICdyZWZlcmVudCcpO1xuICAgICAgICBjb25zdCBtb2NrRnNFeGlzdHMgPSBJbXBvcnRNb2NrLm1vY2tGdW5jdGlvbihmcywgJ2V4aXN0c1N5bmMnKTtcbiAgICAgICAgdHJ5IHtcbiAgICAgICAgICB0ZXN0Lm9rKCF1dGlsLnNob3VsZEZvbGxvdyhGb2xsb3dNb2RlLkJMT0NLX0VYVEVSTkFMLCBzb3VyY2VSb290LCBsaW5rVGFyZ2V0KSk7XG4gICAgICAgICAgdGVzdC5vayhtb2NrRnNFeGlzdHMubm90Q2FsbGVkKTtcbiAgICAgICAgICB0ZXN0LmRvbmUoKTtcbiAgICAgICAgfSBmaW5hbGx5IHtcbiAgICAgICAgICBtb2NrRnNFeGlzdHMucmVzdG9yZSgpO1xuICAgICAgICB9XG4gICAgICB9LFxuICAgIH0sXG5cbiAgICBuZXZlcjoge1xuICAgICAgJ2RvZXMgbm90IGZvbGxvdyBpbnRlcm5hbCcodGVzdDogVGVzdCkge1xuICAgICAgICBjb25zdCBzb3VyY2VSb290ID0gcGF0aC5qb2luKCdzb3VyY2UnLCAncm9vdCcpO1xuICAgICAgICBjb25zdCBsaW5rVGFyZ2V0ID0gcGF0aC5qb2luKHNvdXJjZVJvb3QsICdyZWZlcmVudCcpO1xuICAgICAgICBjb25zdCBtb2NrRnNFeGlzdHMgPSBJbXBvcnRNb2NrLm1vY2tGdW5jdGlvbihmcywgJ2V4aXN0c1N5bmMnKTtcbiAgICAgICAgdHJ5IHtcbiAgICAgICAgICB0ZXN0Lm9rKCF1dGlsLnNob3VsZEZvbGxvdyhGb2xsb3dNb2RlLk5FVkVSLCBzb3VyY2VSb290LCBsaW5rVGFyZ2V0KSk7XG4gICAgICAgICAgdGVzdC5vayhtb2NrRnNFeGlzdHMubm90Q2FsbGVkKTtcbiAgICAgICAgICB0ZXN0LmRvbmUoKTtcbiAgICAgICAgfSBmaW5hbGx5IHtcbiAgICAgICAgICBtb2NrRnNFeGlzdHMucmVzdG9yZSgpO1xuICAgICAgICB9XG4gICAgICB9LFxuXG4gICAgICAnZG9lcyBub3QgZm9sbG93IGV4dGVybmFsJyh0ZXN0OiBUZXN0KSB7XG4gICAgICAgIGNvbnN0IHNvdXJjZVJvb3QgPSBwYXRoLmpvaW4oJ3NvdXJjZScsICdyb290Jyk7XG4gICAgICAgIGNvbnN0IGxpbmtUYXJnZXQgPSBwYXRoLmpvaW4oJ2FsdGVybmF0ZScsICdyZWZlcmVudCcpO1xuICAgICAgICBjb25zdCBtb2NrRnNFeGlzdHMgPSBJbXBvcnRNb2NrLm1vY2tGdW5jdGlvbihmcywgJ2V4aXN0c1N5bmMnKTtcbiAgICAgICAgdHJ5IHtcbiAgICAgICAgICB0ZXN0Lm9rKCF1dGlsLnNob3VsZEZvbGxvdyhGb2xsb3dNb2RlLk5FVkVSLCBzb3VyY2VSb290LCBsaW5rVGFyZ2V0KSk7XG4gICAgICAgICAgdGVzdC5vayhtb2NrRnNFeGlzdHMubm90Q2FsbGVkKTtcbiAgICAgICAgICB0ZXN0LmRvbmUoKTtcbiAgICAgICAgfSBmaW5hbGx5IHtcbiAgICAgICAgICBtb2NrRnNFeGlzdHMucmVzdG9yZSgpO1xuICAgICAgICB9XG4gICAgICB9LFxuICAgIH1cbiAgfSxcblxuICBzaG91bGRFeGNsdWRlRGVlcDoge1xuICAgICd3aXRob3V0IHBhdHRlcm4nKHRlc3Q6IFRlc3QpIHtcbiAgICAgIHRlc3RTaG91bGRFeGNsdWRlRGVlcCh0ZXN0LCBbXSwgW10sIFsnZm9vLnR4dCddKTtcbiAgICAgIHRlc3RTaG91bGRFeGNsdWRlRGVlcCh0ZXN0LCBbJyddLCBbXSwgWydmb28udHh0J10pO1xuICAgICAgdGVzdFNob3VsZEV4Y2x1ZGVEZWVwKHRlc3QsIFsnIyBjb21tZW50J10sIFtdLCBbJ2Zvby50eHQnXSk7XG5cbiAgICAgIHRlc3QuZG9uZSgpO1xuICAgIH0sXG4gICAgJ2Jhc2ljIHVzYWdlJyh0ZXN0OiBUZXN0KSB7XG4gICAgICB0ZXN0U2hvdWxkRXhjbHVkZURlZXAodGVzdCwgWydmb28udHh0J10sIFtcbiAgICAgICAgJ2Zvby50eHQnLFxuICAgICAgICAnZm9vLnR4dC9maWxlJyxcbiAgICAgICAgJ2Rpci9mb28udHh0JyxcbiAgICAgIF0sIFtcbiAgICAgICAgJ2Jhci50eHQnLFxuICAgICAgICAnZm9vJyxcbiAgICAgICAgJ2Zvby50eHQub2xkJyxcbiAgICAgIF0pO1xuXG4gICAgICB0ZXN0LmRvbmUoKTtcbiAgICB9LFxuICAgICduZWdhdGl2ZSBjb250cmlkYWN0b3J5Jyh0ZXN0OiBUZXN0KSB7XG4gICAgICB0ZXN0U2hvdWxkRXhjbHVkZURlZXAodGVzdCwgWydmb28udHh0JywgJyFmb28udHh0J10sIFtdLCBbJ2Zvby50eHQnXSk7XG5cbiAgICAgIHRlc3QuZG9uZSgpO1xuICAgIH0sXG4gICAgJ3Bvc2l0aXZlIGNvbnRyaWRhY3RvcnknKHRlc3Q6IFRlc3QpIHtcbiAgICAgIHRlc3RTaG91bGRFeGNsdWRlRGVlcCh0ZXN0LCBbJyFmb28udHh0JywgJ2Zvby50eHQnXSwgWydmb28udHh0J10sIFtdKTtcblxuICAgICAgdGVzdC5kb25lKCk7XG4gICAgfSxcbiAgICAnZGlyIHNpbmdsZSB3aWxkY2FyZCcodGVzdDogVGVzdCkge1xuICAgICAgdGVzdFNob3VsZEV4Y2x1ZGVEZWVwKHRlc3QsIFsnZD9yJ10sIFtcbiAgICAgICAgJ2RpcicsXG4gICAgICAgICdkaXIvZXhjbHVkZScsXG4gICAgICAgICdkaXIvZXhjbHVkZS9maWxlJyxcbiAgICAgIF0sIFtcbiAgICAgICAgJ2Rvb3InLFxuICAgICAgICAnZG9vci9maWxlJyxcbiAgICAgIF0pO1xuXG4gICAgICB0ZXN0LmRvbmUoKTtcbiAgICB9LFxuICAgICdkaXIgd2lsZGNhcmQnKHRlc3Q6IFRlc3QpIHtcbiAgICAgIHRlc3RTaG91bGRFeGNsdWRlRGVlcCh0ZXN0LCBbJ2QqciddLCBbXG4gICAgICAgICdkaXInLFxuICAgICAgICAnZGlyL2ZpbGUnLFxuICAgICAgICAnZG9vcicsXG4gICAgICAgICdkb29yL2ZpbGUnLFxuICAgICAgXSwgW1xuICAgICAgICAnZG9nJyxcbiAgICAgICAgJ2RvZy9maWxlJyxcbiAgICAgIF0pO1xuXG4gICAgICB0ZXN0LmRvbmUoKTtcbiAgICB9LFxuICAgICdkaXIgZGVlcCB3aWxkY2FyZCcodGVzdDogVGVzdCkge1xuICAgICAgdGVzdFNob3VsZEV4Y2x1ZGVEZWVwKHRlc3QsIFsnZGlyLyoqLyonLCAnIWRpci9pbmNsdWRlLyoqLyonXSwgW1xuICAgICAgICAnZGlyL2RlZXAnLFxuICAgICAgICAnZGlyL2RlZXAvZmlsZScsXG4gICAgICAgICdkaXIvZGVlcC9kZWVwZXIvZmlsZScsXG4gICAgICAgICdkaXIvaW5jbHVkZScsXG4gICAgICBdLCBbXG4gICAgICAgICdkaXInLFxuICAgICAgICAnZGlyL2luY2x1ZGUvZGVlcCcsXG4gICAgICAgICdkaXIvaW5jbHVkZS9kZWVwL2RlZXBlcicsXG4gICAgICBdKTtcblxuICAgICAgdGVzdC5kb25lKCk7XG4gICAgfSxcbiAgICAnZGVlcCBzdHJ1Y3R1cmUnKHRlc3Q6IFRlc3QpIHtcbiAgICAgIHRlc3RTaG91bGRFeGNsdWRlRGVlcCh0ZXN0LCBbJ2RlZXAvZXhjbHVkZSddLCBbXG4gICAgICAgICdkZWVwL2V4Y2x1ZGUnLFxuICAgICAgICAnZGVlcC9leGNsdWRlL2ZpbGUnLFxuICAgICAgXSwgW1xuICAgICAgICAnZGVlcCcsXG4gICAgICAgICdkZWVwL2luY2x1ZGUnLFxuICAgICAgICAnZGVlcC9pbmNsdWRlL2ZpbGUnLFxuICAgICAgXSk7XG5cbiAgICAgIHRlc3QuZG9uZSgpO1xuICAgIH0sXG4gICAgJ2ludmVydGVkIHBhdHRlcm4nKHRlc3Q6IFRlc3QpIHtcbiAgICAgIHRlc3RTaG91bGRFeGNsdWRlRGVlcCh0ZXN0LCBbJyonLCAnIWZvby50eHQnLCAnIWQ/cicsICdkaXIvZXhjbHVkZSddLCBbXG4gICAgICAgICdiYXIudHh0JyxcbiAgICAgICAgJ2Rpci9leGNsdWRlJyxcbiAgICAgICAgJ2Rpci9leGNsdWRlL2ZpbGUnLFxuICAgICAgXSwgW1xuICAgICAgICAnLmhpZGRlbi1maWxlJyxcbiAgICAgICAgJ2Zvby50eHQnLFxuICAgICAgICAnZGlyJyxcbiAgICAgICAgJ2Rpci9pbmNsdWRlJyxcbiAgICAgICAgJ2Rpci9pbmNsdWRlL3N1YmRpcicsXG4gICAgICAgICdleGNsdWRlL2Zvby50eHQnLFxuICAgICAgXSk7XG5cbiAgICAgIHRlc3QuZG9uZSgpO1xuICAgIH0sXG4gIH0sXG5cbiAgc2hvdWxkRXhjbHVkZURpcmVjdG9yeToge1xuICAgICd3aXRob3V0IHBhdHRlcm4nKHRlc3Q6IFRlc3QpIHtcbiAgICAgIHRlc3RTaG91bGRFeGNsdWRlRGlyZWN0b3J5KHRlc3QsIFtdLCBbXSwgWydkaXInXSk7XG4gICAgICB0ZXN0U2hvdWxkRXhjbHVkZURpcmVjdG9yeSh0ZXN0LCBbJyddLCBbXSwgWydkaXInXSk7XG4gICAgICB0ZXN0U2hvdWxkRXhjbHVkZURpcmVjdG9yeSh0ZXN0LCBbJyMgY29tbWVudCddLCBbXSwgWydkaXInXSk7XG5cbiAgICAgIHRlc3QuZG9uZSgpO1xuICAgIH0sXG4gICAgJ2Jhc2ljIHVzYWdlJyh0ZXN0OiBUZXN0KSB7XG4gICAgICBjb25zdCBwYXR0ZXJuID0gWydkaXInLCAnIWRpci8qJywgJ290aGVyX2RpciddO1xuXG4gICAgICB0ZXN0U2hvdWxkRXhjbHVkZURlZXAodGVzdCwgcGF0dGVybiwgWydkaXInLCAnb3RoZXJfZGlyJ10sIFsnZGlyL2ZpbGUnXSk7XG4gICAgICB0ZXN0U2hvdWxkRXhjbHVkZURpcmVjdG9yeSh0ZXN0LCBwYXR0ZXJuLCBbJ2Rpci9kZWVwJywgJ290aGVyX2RpciddLCBbJ2RpciddKTtcblxuICAgICAgdGVzdC5kb25lKCk7XG4gICAgfSxcbiAgICAnZGVlcCBzdHJ1Y3R1cmUnKHRlc3Q6IFRlc3QpIHtcbiAgICAgIGNvbnN0IHBhdHRlcm4gPSBbJ2RpcicsICchZGlyL3N1YmRpci8/JywgJ290aGVyX2RpcicsICdyZWFsbHkvZGVlcC9zdHJ1Y3R1cmUvb2YvZmlsZXMvYW5kL2RpcnMnXTtcblxuICAgICAgdGVzdFNob3VsZEV4Y2x1ZGVEZWVwKHRlc3QsIHBhdHRlcm4sXG4gICAgICAgIFsnZGlyJywgJ2Rpci9zdWJkaXInLCAnb3RoZXJfZGlyJ10sXG4gICAgICAgIFsnZGlyL3N1YmRpci9hJ11cbiAgICAgICk7XG4gICAgICB0ZXN0U2hvdWxkRXhjbHVkZURpcmVjdG9yeSh0ZXN0LCBwYXR0ZXJuLFxuICAgICAgICBbJ290aGVyX2RpcicsICdkaXIvc3ViZGlyL2QnXSxcbiAgICAgICAgWydkaXInLCAnZGlyL3N1YmRpciddXG4gICAgICApO1xuXG4gICAgICB0ZXN0LmRvbmUoKTtcbiAgICB9LFxuICAgICd3aWxkY2FyZCBwYXR0ZXJuJyh0ZXN0OiBUZXN0KSB7XG4gICAgICBjb25zdCBwYXR0ZXJuID0gWydkaXInLCAnIWRpci8qLyonLCAnb3RoZXJfZGlyJ107XG5cbiAgICAgIHRlc3RTaG91bGRFeGNsdWRlRGVlcCh0ZXN0LCBwYXR0ZXJuLFxuICAgICAgICBbJ2RpcicsICdvdGhlcl9kaXInLCAnZGlyL2ZpbGUnXSxcbiAgICAgICAgWydkaXIvZmlsZS9kZWVwJ11cbiAgICAgICk7XG4gICAgICB0ZXN0U2hvdWxkRXhjbHVkZURpcmVjdG9yeSh0ZXN0LCBwYXR0ZXJuLFxuICAgICAgICBbJ290aGVyX2RpcicsICdkaXIvZGVlcC9zdHJ1Y3QnXSxcbiAgICAgICAgWydkaXInLCAnZGlyL2RlZXAnLCAnZGlyL2RlZXAnXVxuICAgICAgKTtcblxuICAgICAgdGVzdC5kb25lKCk7XG4gICAgfSxcbiAgICAnZGVlcCB3aWxkY2FyZCcodGVzdDogVGVzdCkge1xuICAgICAgY29uc3QgcGF0dGVybiA9IFsnZGlyJywgJyFkaXIvKiovKicsICdvdGhlcl9kaXInXTtcblxuICAgICAgdGVzdFNob3VsZEV4Y2x1ZGVEZWVwKHRlc3QsIHBhdHRlcm4sXG4gICAgICAgIFsnZGlyJywgJ290aGVyX2RpciddLFxuICAgICAgICBbJ2Rpci9maWxlJywgJ2Rpci9maWxlL2RlZXAnXVxuICAgICAgKTtcbiAgICAgIHRlc3RTaG91bGRFeGNsdWRlRGlyZWN0b3J5KHRlc3QsIHBhdHRlcm4sXG4gICAgICAgIFsnb3RoZXJfZGlyJ10sXG4gICAgICAgIFsnZGlyJywgJ2Rpci9kZWVwJywgJ2Rpci9kZWVwL3N0cnVjdCcsICdkaXIvcmVhbGx5L3JlYWxseS9yZWFsbHkvcmVhbGx5L2RlZXAnXVxuICAgICAgKTtcblxuICAgICAgdGVzdC5kb25lKCk7XG4gICAgfSxcbiAgfSxcblxuICBsaXN0RmlsZXNSZWN1cnNpdmVseToge1xuICAgICdiYXNpYyB1c2FnZScodGVzdDogVGVzdCkge1xuICAgICAgY29uc3QgZXhjbHVkZSA9IFsnJ107XG4gICAgICBjb25zdCBmb2xsb3cgPSBGb2xsb3dNb2RlLkFMV0FZUztcbiAgICAgIGNvbnN0IHRyZWUgPSBgXG4gICAgICDilJzilIDilIAgZGlyZWN0b3J5XG4gICAgICDilILCoMKgIOKUnOKUgOKUgCBmb28udHh0XG4gICAgICDilILCoMKgIOKUlOKUgOKUgCBiYXIudHh0XG4gICAgICDilJzilIDilIAgZW1wdHktZGlyIChEKVxuICAgICAg4pSc4pSA4pSAIGRlZXBcbiAgICAgIOKUgsKgwqAg4pSc4pSA4pSAIGRpclxuICAgICAg4pSCwqDCoCDilILCoMKgIOKUlOKUgOKUgCBzdHJ1Y3RcbiAgICAgIOKUgsKgwqAg4pSCwqDCoCAgICAg4pSU4pSA4pSAIHF1eC50eHRcbiAgICAgIOKUnOKUgOKUgCBmb29iYXIudHh0YDtcblxuICAgICAgY29uc3QgeyBkaXJlY3RvcnksIGNsZWFudXAgfSA9IEZzVXRpbHMuZnJvbVRyZWUoJ2Jhc2ljJywgdHJlZSk7XG4gICAgICBjb25zdCBwYXRocyA9IHV0aWwubGlzdEZpbGVzUmVjdXJzaXZlbHkoZGlyZWN0b3J5LCB7IGV4Y2x1ZGUsIGZvbGxvdyB9KS5tYXAoKHsgcmVsYXRpdmVQYXRoIH0pID0+IHJlbGF0aXZlUGF0aCk7XG5cbiAgICAgIHRlc3QuZGVlcEVxdWFsKHBhdGhzLCBbXG4gICAgICAgICdkZWVwL2Rpci9zdHJ1Y3QvcXV4LnR4dCcsXG4gICAgICAgICdkaXJlY3RvcnkvYmFyLnR4dCcsXG4gICAgICAgICdkaXJlY3RvcnkvZm9vLnR4dCcsXG4gICAgICAgICdlbXB0eS1kaXInLFxuICAgICAgICAnZm9vYmFyLnR4dCcsXG4gICAgICBdKTtcblxuICAgICAgY2xlYW51cCgpO1xuICAgICAgdGVzdC5kb25lKCk7XG4gICAgfSxcbiAgICAnZXhjbHVkZScodGVzdDogVGVzdCkge1xuICAgICAgY29uc3QgZXhjbHVkZSA9IFsnZm9vYmFyLnR4dCcsICdkZWVwJywgJyFkZWVwL2Zvby50eHQnXTtcbiAgICAgIGNvbnN0IGZvbGxvdyA9IEZvbGxvd01vZGUuQUxXQVlTO1xuICAgICAgY29uc3QgdHJlZSA9IGBcbiAgICAgIOKUnOKUgOKUgCBkaXJlY3RvcnlcbiAgICAgIOKUgsKgwqAg4pSc4pSA4pSAIGZvby50eHRcbiAgICAgIOKUgsKgwqAg4pSU4pSA4pSAIGJhci50eHRcbiAgICAgIOKUnOKUgOKUgCBkZWVwXG4gICAgICDilILCoMKgIOKUnOKUgOKUgCBkaXJcbiAgICAgIOKUgsKgwqAg4pSCwqDCoCDilJTilIDilIAgc3RydWN0XG4gICAgICDilILCoMKgIOKUgsKgwqAgICAgIOKUlOKUgOKUgCBxdXgudHh0XG4gICAgICDilILCoMKgIOKUnOKUgOKUgCBmb28udHh0XG4gICAgICDilILCoMKgIOKUlOKUgOKUgCBiYXIudHh0XG4gICAgICDilJzilIDilIAgZm9vYmFyLnR4dGA7XG5cbiAgICAgIGNvbnN0IHsgZGlyZWN0b3J5LCBjbGVhbnVwIH0gPSBGc1V0aWxzLmZyb21UcmVlKCdleGNsdWRlJywgdHJlZSk7XG4gICAgICBjb25zdCBwYXRocyA9IHV0aWwubGlzdEZpbGVzUmVjdXJzaXZlbHkoZGlyZWN0b3J5LCB7IGV4Y2x1ZGUsIGZvbGxvdyB9KS5tYXAoKHsgcmVsYXRpdmVQYXRoIH0pID0+IHJlbGF0aXZlUGF0aCk7XG5cbiAgICAgIHRlc3QuZGVlcEVxdWFsKHBhdGhzLCBbXG4gICAgICAgICdkZWVwL2Zvby50eHQnLFxuICAgICAgICAnZGlyZWN0b3J5L2Jhci50eHQnLFxuICAgICAgICAnZGlyZWN0b3J5L2Zvby50eHQnLFxuICAgICAgXSk7XG5cbiAgICAgIGNsZWFudXAoKTtcbiAgICAgIHRlc3QuZG9uZSgpO1xuICAgIH0sXG4gICAgJ3N5bWxpbmtzJzoge1xuICAgICAgJ3dpdGhvdXQgZXhjbHVzaW9uJyh0ZXN0OiBUZXN0KSB7XG4gICAgICAgIGNvbnN0IGV4Y2x1ZGUgPSBbJyddO1xuICAgICAgICBjb25zdCBleHRlcm5hbFRyZWUgPSBGc1V0aWxzLmZyb21UcmVlKCdleGNsdWRlJywgYFxuICAgICAgICAgIOKUnOKUgOKUgCBleHRlcm5hbF9kaXJcbiAgICAgICAgICDilILCoMKgIOKUnOKUgOKUgCBmb29iYXIudHh0YCk7XG5cbiAgICAgICAgY29uc3QgaW50ZXJuYWxUcmVlID0gRnNVdGlscy5mcm9tVHJlZSgnZXhjbHVkZScsIGBcbiAgICAgICAgICDilJzilIDilIAgZGlyZWN0b3J5XG4gICAgICAgICAg4pSCwqDCoCDilJzilIDilIAgZm9vLnR4dFxuICAgICAgICAgIOKUnOKUgOKUgCBpbnRlcm5hbF9saW5rIC0+IGRpcmVjdG9yeVxuICAgICAgICAgIOKUnOKUgOKUgCBleHRlcm5hbF9saW5rIC0+IC4uLyR7cGF0aC5yZWxhdGl2ZShvcy50bXBkaXIoKSwgZXh0ZXJuYWxUcmVlLmRpcmVjdG9yeSl9L2V4dGVybmFsX2RpcmApO1xuXG4gICAgICAgIGNvbnN0IGV4cGVjdGVkOiB7IFtmb2xsb3dNb2RlIGluIEZvbGxvd01vZGVdOiBzdHJpbmdbXSB9ID0ge1xuICAgICAgICAgIFtGb2xsb3dNb2RlLk5FVkVSXTogW1xuICAgICAgICAgICAgJ2RpcmVjdG9yeS9mb28udHh0JyxcbiAgICAgICAgICAgICdleHRlcm5hbF9saW5rJyxcbiAgICAgICAgICAgICdpbnRlcm5hbF9saW5rJyxcbiAgICAgICAgICBdLFxuICAgICAgICAgIFtGb2xsb3dNb2RlLkFMV0FZU106IFtcbiAgICAgICAgICAgICdkaXJlY3RvcnkvZm9vLnR4dCcsXG4gICAgICAgICAgICAnZXh0ZXJuYWxfbGluay9mb29iYXIudHh0JyxcbiAgICAgICAgICAgICdpbnRlcm5hbF9saW5rL2Zvby50eHQnLFxuICAgICAgICAgIF0sXG4gICAgICAgICAgW0ZvbGxvd01vZGUuRVhURVJOQUxdOiBbXG4gICAgICAgICAgICAnZGlyZWN0b3J5L2Zvby50eHQnLFxuICAgICAgICAgICAgJ2V4dGVybmFsX2xpbmsvZm9vYmFyLnR4dCcsXG4gICAgICAgICAgICAnaW50ZXJuYWxfbGluaydcbiAgICAgICAgICBdLFxuICAgICAgICAgIFtGb2xsb3dNb2RlLkJMT0NLX0VYVEVSTkFMXTogW1xuICAgICAgICAgICAgJ2RpcmVjdG9yeS9mb28udHh0JyxcbiAgICAgICAgICAgICdleHRlcm5hbF9saW5rJyxcbiAgICAgICAgICAgICdpbnRlcm5hbF9saW5rL2Zvby50eHQnLFxuICAgICAgICAgIF0sXG4gICAgICAgIH07XG5cbiAgICAgICAgZm9yIChjb25zdCBmb2xsb3cgb2YgT2JqZWN0LnZhbHVlcyhGb2xsb3dNb2RlKSkge1xuICAgICAgICAgIGNvbnN0IHBhdGhzID0gdXRpbC5saXN0RmlsZXNSZWN1cnNpdmVseShpbnRlcm5hbFRyZWUuZGlyZWN0b3J5LCB7IGV4Y2x1ZGUsIGZvbGxvdyB9KS5tYXAoKHsgcmVsYXRpdmVQYXRoIH0pID0+IHJlbGF0aXZlUGF0aCk7XG5cbiAgICAgICAgICB0ZXN0LmRlZXBFcXVhbChwYXRocywgZXhwZWN0ZWRbZm9sbG93XSwgZm9sbG93KTtcbiAgICAgICAgfVxuXG4gICAgICAgIGludGVybmFsVHJlZS5jbGVhbnVwKCk7XG4gICAgICAgIGV4dGVybmFsVHJlZS5jbGVhbnVwKCk7XG4gICAgICAgIHRlc3QuZG9uZSgpO1xuICAgICAgfSxcbiAgICB9LFxuICAgICdleGNsdWRlIHRhcmdldHMnKHRlc3Q6IFRlc3QpIHtcbiAgICAgIGNvbnN0IGV4Y2x1ZGUgPSBbJ2V4dGVybmFsX2RpcicsICdkaXJlY3RvcnknXTtcbiAgICAgIGNvbnN0IGZvbGxvdyA9IEZvbGxvd01vZGUuQUxXQVlTO1xuICAgICAgY29uc3QgZXh0ZXJuYWxUcmVlID0gRnNVdGlscy5mcm9tVHJlZSgnZXhjbHVkZScsIGBcbiAgICAgICAg4pSc4pSA4pSAIGV4dGVybmFsX2RpclxuICAgICAgICDilILCoMKgIOKUnOKUgOKUgCBmb29iYXIudHh0YCk7XG5cbiAgICAgIGNvbnN0IGludGVybmFsVHJlZSA9IEZzVXRpbHMuZnJvbVRyZWUoJ2V4Y2x1ZGUnLCBgXG4gICAgICAgIOKUnOKUgOKUgCBkaXJlY3RvcnlcbiAgICAgICAg4pSCwqDCoCDilJzilIDilIAgZm9vLnR4dFxuICAgICAgICDilJzilIDilIAgaW50ZXJuYWxfbGluayAtPiBkaXJlY3RvcnlcbiAgICAgICAg4pSc4pSA4pSAIGV4dGVybmFsX2xpbmsgLT4gLi4vJHtwYXRoLnJlbGF0aXZlKG9zLnRtcGRpcigpLCBleHRlcm5hbFRyZWUuZGlyZWN0b3J5KX0vZXh0ZXJuYWxfZGlyYCk7XG4gICAgICBjb25zdCBwYXRocyA9IHV0aWwubGlzdEZpbGVzUmVjdXJzaXZlbHkoaW50ZXJuYWxUcmVlLmRpcmVjdG9yeSwgeyBleGNsdWRlLCBmb2xsb3cgfSkubWFwKCh7IHJlbGF0aXZlUGF0aCB9KSA9PiByZWxhdGl2ZVBhdGgpO1xuXG4gICAgICB0ZXN0LmRlZXBFcXVhbChwYXRocywgW1xuICAgICAgICAnZXh0ZXJuYWxfbGluay9mb29iYXIudHh0JyxcbiAgICAgICAgJ2ludGVybmFsX2xpbmsvZm9vLnR4dCdcbiAgICAgIF0pO1xuXG4gICAgICBpbnRlcm5hbFRyZWUuY2xlYW51cCgpO1xuICAgICAgZXh0ZXJuYWxUcmVlLmNsZWFudXAoKTtcbiAgICAgIHRlc3QuZG9uZSgpO1xuICAgIH0sXG4gICAgJ2V4Y2x1ZGUgbGlua3MnKHRlc3Q6IFRlc3QpIHtcbiAgICAgIGNvbnN0IGV4Y2x1ZGUgPSBbJ2ludGVybmFsX2xpbmsnLCAnZXh0ZXJuYWxfbGluayddO1xuICAgICAgY29uc3QgZm9sbG93ID0gRm9sbG93TW9kZS5BTFdBWVM7XG4gICAgICBjb25zdCBleHRlcm5hbFRyZWUgPSBGc1V0aWxzLmZyb21UcmVlKCdleGNsdWRlJywgYFxuICAgICAgICDilJzilIDilIAgZXh0ZXJuYWxfZGlyXG4gICAgICAgIOKUgsKgwqAg4pSc4pSA4pSAIGZvb2Jhci50eHRgKTtcblxuICAgICAgY29uc3QgaW50ZXJuYWxUcmVlID0gRnNVdGlscy5mcm9tVHJlZSgnZXhjbHVkZScsIGBcbiAgICAgICAg4pSc4pSA4pSAIGRpcmVjdG9yeVxuICAgICAgICDilILCoMKgIOKUnOKUgOKUgCBmb28udHh0XG4gICAgICAgIOKUnOKUgOKUgCBpbnRlcm5hbF9saW5rIC0+IGRpcmVjdG9yeVxuICAgICAgICDilJzilIDilIAgZXh0ZXJuYWxfbGluayAtPiAuLi8ke3BhdGgucmVsYXRpdmUob3MudG1wZGlyKCksIGV4dGVybmFsVHJlZS5kaXJlY3RvcnkpfS9leHRlcm5hbF9kaXJgKTtcbiAgICAgIGNvbnN0IHBhdGhzID0gdXRpbC5saXN0RmlsZXNSZWN1cnNpdmVseShpbnRlcm5hbFRyZWUuZGlyZWN0b3J5LCB7IGV4Y2x1ZGUsIGZvbGxvdyB9KS5tYXAoKHsgcmVsYXRpdmVQYXRoIH0pID0+IHJlbGF0aXZlUGF0aCk7XG5cbiAgICAgIHRlc3QuZGVlcEVxdWFsKHBhdGhzLCBbXG4gICAgICAgICdkaXJlY3RvcnkvZm9vLnR4dCdcbiAgICAgIF0pO1xuXG4gICAgICBpbnRlcm5hbFRyZWUuY2xlYW51cCgpO1xuICAgICAgZXh0ZXJuYWxUcmVlLmNsZWFudXAoKTtcbiAgICAgIHRlc3QuZG9uZSgpO1xuICAgIH0sXG4gIH0sXG59O1xuXG5jb25zdCB0ZXN0U2hvdWxkRXhjbHVkZSA9IChcbiAgdGVzdDogVGVzdCxcbiAgcGF0dGVybjogc3RyaW5nW10sXG4gIGV4cGVjdEV4Y2x1ZGU6IHN0cmluZ1tdLFxuICBleHBlY3RJbmNsdWRlOiBzdHJpbmdbXSxcbiAgc2hvdWxkRXhjbHVkZU1ldGhvZDogKHBhdHRlcm46IHN0cmluZ1tdLCBwYXRoOiBzdHJpbmcpID0+IGJvb2xlYW4pID0+IHtcbiAgZm9yIChjb25zdCBleGNsdWRlIG9mIGV4cGVjdEV4Y2x1ZGUpIHtcbiAgICB0ZXN0Lm9rKHNob3VsZEV4Y2x1ZGVNZXRob2QocGF0dGVybiwgZXhjbHVkZSksIGAke2V4Y2x1ZGV9IHNob3VsZCBoYXZlIGJlZW4gZXhjbHVkZWQsIGJ1dCB3YXNuJ3RgKTtcbiAgfVxuICBmb3IgKGNvbnN0IGluY2x1ZGUgb2YgZXhwZWN0SW5jbHVkZSkge1xuICAgIHRlc3Qub2soIXNob3VsZEV4Y2x1ZGVNZXRob2QocGF0dGVybiwgaW5jbHVkZSksIGAke2luY2x1ZGV9IHNob3VsZCBoYXZlIGJlZW4gaW5jbHVkZWQsIGJ1dCB3YXNuJ3RgKTtcbiAgfVxufTtcblxuY29uc3QgdGVzdFNob3VsZEV4Y2x1ZGVEZWVwID0gKHRlc3Q6IFRlc3QsIHBhdHRlcm46IHN0cmluZ1tdLCBleHBlY3RFeGNsdWRlOiBzdHJpbmdbXSwgZXhwZWN0SW5jbHVkZTogc3RyaW5nW10pID0+XG4gIHRlc3RTaG91bGRFeGNsdWRlKHRlc3QsIHBhdHRlcm4sIGV4cGVjdEV4Y2x1ZGUsIGV4cGVjdEluY2x1ZGUsIChwYXR0ZXJuczogc3RyaW5nW10sIF9wYXRoOiBzdHJpbmcpID0+IHtcbiAgICBjb25zdCBleGNsdWRlUnVsZXMgPSBuZXcgdXRpbC5FeGNsdWRlUnVsZXMocGF0dGVybnMpO1xuICAgIHJldHVybiBleGNsdWRlUnVsZXMuZXhjbHVkZUZpbGUoX3BhdGgpO1xuICB9KTtcblxuY29uc3QgdGVzdFNob3VsZEV4Y2x1ZGVEaXJlY3RvcnkgPSAodGVzdDogVGVzdCwgcGF0dGVybjogc3RyaW5nW10sIGV4cGVjdEV4Y2x1ZGU6IHN0cmluZ1tdLCBleHBlY3RJbmNsdWRlOiBzdHJpbmdbXSkgPT5cbiAgdGVzdFNob3VsZEV4Y2x1ZGUodGVzdCwgcGF0dGVybiwgZXhwZWN0RXhjbHVkZSwgZXhwZWN0SW5jbHVkZSwgKHBhdHRlcm5zOiBzdHJpbmdbXSwgX3BhdGg6IHN0cmluZykgPT4ge1xuICAgIGNvbnN0IGV4Y2x1ZGVSdWxlcyA9IG5ldyB1dGlsLkV4Y2x1ZGVSdWxlcyhwYXR0ZXJucyk7XG4gICAgcmV0dXJuIGV4Y2x1ZGVSdWxlcy5leGNsdWRlRGlyZWN0b3J5KF9wYXRoKTtcbiAgfSk7Il19