"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
require("source-map-support/register");
const cdk = require("@aws-cdk/core");
const core_1 = require("@aws-cdk/core");
const index_1 = require("../lib/index");
passingExample('expect <synthStack> at <some path> to have <some type>', () => {
    const resourceType = 'Test::Resource';
    const synthStack = synthesizedStack(stack => {
        new TestResource(stack, 'TestResource', { type: resourceType });
    });
    index_1.expect(synthStack).at('/TestResource').to(index_1.haveType(resourceType));
});
passingExample('expect non-synthesized stack at <some path> to have <some type>', () => {
    const resourceType = 'Test::Resource';
    const stack = new cdk.Stack();
    new TestResource(stack, 'TestResource', { type: resourceType });
    index_1.expect(stack).at('/TestResource').to(index_1.haveType(resourceType));
});
passingExample('expect <synthStack> at <some path> *not* to have <some type>', () => {
    const resourceType = 'Test::Resource';
    const synthStack = synthesizedStack(stack => {
        new TestResource(stack, 'TestResource', { type: resourceType });
    });
    index_1.expect(synthStack).at('/TestResource').notTo(index_1.haveType('Foo::Bar'));
});
passingExample('expect <synthStack> at <some path> to exist', () => {
    const resourceType = 'Test::Resource';
    const synthStack = synthesizedStack(stack => {
        new TestResource(stack, 'TestResource', { type: resourceType });
    });
    index_1.expect(synthStack).at('/TestResource').to(index_1.exist());
});
passingExample('expect <synthStack> to match (exactly) <template>', () => {
    const resourceType = 'Test::Resource';
    const synthStack = synthesizedStack(stack => {
        new TestResource(stack, 'TestResource', { type: resourceType });
    });
    const expected = {
        Resources: {
            TestResource: { Type: resourceType }
        }
    };
    index_1.expect(synthStack).to(index_1.matchTemplate(expected, index_1.MatchStyle.EXACT));
});
passingExample('expect <synthStack> to match (no replaces) <template>', () => {
    const resourceType = 'Test::Resource';
    const synthStack = synthesizedStack(stack => {
        new TestResource(stack, 'TestResource', { type: resourceType });
    });
    const expected = {};
    index_1.expect(synthStack).to(index_1.matchTemplate(expected, index_1.MatchStyle.NO_REPLACES));
});
passingExample('expect <synthStack> to be a superset of <template>', () => {
    const resourceType = 'Test::Resource';
    const synthStack = synthesizedStack(stack => {
        // Added
        new TestResource(stack, 'NewResource', { type: 'AWS::S3::Bucket' });
        // Expected
        new TestResource(stack, 'TestResourceA', { type: resourceType });
        new TestResource(stack, 'TestResourceB', { type: resourceType, properties: { Foo: 'Bar' } });
    });
    const expected = {
        Resources: {
            TestResourceA: { Type: 'Test::Resource' },
            TestResourceB: { Type: 'Test::Resource', Properties: { Foo: 'Bar' } }
        }
    };
    index_1.expect(synthStack).to(index_1.matchTemplate(expected, index_1.MatchStyle.SUPERSET));
});
passingExample('sugar for matching stack to a template', () => {
    const stack = new core_1.Stack();
    new TestResource(stack, 'TestResource', { type: 'Test::Resource' });
    index_1.expect(stack).toMatch({
        Resources: {
            TestResource: {
                Type: 'Test::Resource'
            }
        }
    });
});
passingExample('expect <synthStack> to match (no replaces) <template> with parameters', () => {
    const parameterType = 'Test::Parameter';
    const synthStack = synthesizedStack(stack => {
        new TestParameter(stack, 'TestParameter', { type: parameterType });
    });
    const expected = {};
    index_1.expect(synthStack).to(index_1.matchTemplate(expected, index_1.MatchStyle.NO_REPLACES));
});
passingExample('expect <synthStack> to be a superset of <template> with parameters', () => {
    const parameterType = 'Test::Parameter';
    const synthStack = synthesizedStack(stack => {
        // Added
        new TestResource(stack, 'NewResource', { type: 'AWS::S3::Bucket' });
        // Expected
        new TestParameter(stack, 'TestParameterA', { type: parameterType });
        new TestParameter(stack, 'TestParameterB', { type: parameterType, default: { Foo: 'Bar' } });
    });
    const expected = {
        Parameters: {
            TestParameterA: { Type: 'Test::Parameter' },
            TestParameterB: { Type: 'Test::Parameter', Default: { Foo: 'Bar' } }
        }
    };
    index_1.expect(synthStack).to(index_1.matchTemplate(expected, index_1.MatchStyle.SUPERSET));
});
failingExample('expect <synthStack> at <some path> *not* to have <some type>', () => {
    const resourceType = 'Test::Resource';
    const synthStack = synthesizedStack(stack => {
        new TestResource(stack, 'TestResource', { type: resourceType });
    });
    index_1.expect(synthStack).at('/TestResource').notTo(index_1.haveType(resourceType));
});
failingExample('expect <synthStack> at <some path> to have <some type>', () => {
    const resourceType = 'Test::Resource';
    const synthStack = synthesizedStack(stack => {
        new TestResource(stack, 'TestResource', { type: resourceType });
    });
    index_1.expect(synthStack).at('/TestResource').to(index_1.haveType('Foo::Bar'));
});
failingExample('expect <synthStack> at <some path> to exist', () => {
    const resourceType = 'Test::Resource';
    const synthStack = synthesizedStack(stack => {
        new TestResource(stack, 'TestResource', { type: resourceType });
    });
    index_1.expect(synthStack).at('/Foo/Bar').to(index_1.exist());
});
failingExample('expect <synthStack> to match (exactly) <template>', () => {
    const resourceType = 'Test::Resource';
    const synthStack = synthesizedStack(stack => {
        new TestResource(stack, 'TestResource', { type: resourceType });
    });
    const expected = {
        Resources: {
            TestResource: { Type: resourceType, DependsOn: ['Something'] }
        }
    };
    index_1.expect(synthStack).to(index_1.matchTemplate(expected, index_1.MatchStyle.EXACT));
});
failingExample('expect <synthStack> to match (no replaces) <template>', () => {
    const resourceType = 'Test::Resource';
    const synthStack = synthesizedStack(stack => {
        new TestResource(stack, 'TestResource', { type: resourceType });
    });
    const expected = {
        Resources: {
            TestResource: { Type: 'AWS::S3::Bucket' }
        }
    };
    index_1.expect(synthStack).to(index_1.matchTemplate(expected, index_1.MatchStyle.NO_REPLACES));
});
failingExample('expect <synthStack> to be a superset of <template>', () => {
    const resourceType = 'Test::Resource';
    const synthStack = synthesizedStack(stack => {
        // Added
        new TestResource(stack, 'NewResource', { type: 'AWS::S3::Bucket' });
        // Expected
        new TestResource(stack, 'TestResourceA', { type: resourceType });
        // Expected, but has different properties - will break
        new TestResource(stack, 'TestResourceB', { type: resourceType, properties: { Foo: 'Bar' } });
    });
    const expected = {
        Resources: {
            TestResourceA: { Type: 'Test::Resource' },
            TestResourceB: { Type: 'Test::Resource', Properties: { Foo: 'Baz' } }
        }
    };
    index_1.expect(synthStack).to(index_1.matchTemplate(expected, index_1.MatchStyle.SUPERSET));
});
failingExample('expect <synthStack> to match (no replaces) <template> with parameters', () => {
    const parameterType = 'Test::Parameter';
    const synthStack = synthesizedStack(stack => {
        new TestParameter(stack, 'TestParameter', { type: parameterType });
    });
    const expected = {
        Parameters: {
            TestParameter: { Type: 'AWS::S3::Bucket' }
        }
    };
    index_1.expect(synthStack).to(index_1.matchTemplate(expected, index_1.MatchStyle.NO_REPLACES));
});
failingExample('expect <synthStack> to be a superset of <template> with parameters', () => {
    const parameterType = 'Test::Parameter';
    const synthStack = synthesizedStack(stack => {
        // Added
        new TestParameter(stack, 'NewParameter', { type: 'AWS::S3::Bucket' });
        // Expected
        new TestParameter(stack, 'TestParameterA', { type: parameterType });
        // Expected, but has different properties - will break
        new TestParameter(stack, 'TestParameterB', { type: parameterType, default: { Foo: 'Bar' } });
    });
    const expected = {
        Parameters: {
            TestParameterA: { Type: 'Test::Parameter' },
            TestParameterB: { Type: 'Test::Parameter', Default: { Foo: 'Baz' } }
        }
    };
    index_1.expect(synthStack).to(index_1.matchTemplate(expected, index_1.MatchStyle.SUPERSET));
});
// countResources
passingExample('expect <synthStack> to count resources - as expected', () => {
    const synthStack = synthesizedStack(stack => {
        new TestResource(stack, 'R1', { type: 'Bar' });
        new TestResource(stack, 'R2', { type: 'Bar' });
        new TestResource(stack, 'R3', { type: 'Foo' });
    });
    index_1.expect(synthStack).to(index_1.countResources('Bar', 2));
    index_1.expect(synthStack).to(index_1.countResources('Foo', 1));
});
passingExample('expect <stack> to count resources - expected no resources', () => {
    const resourceType = 'Test::Resource';
    const stack = new core_1.Stack();
    index_1.expect(stack).to(index_1.countResources(resourceType, 0));
});
failingExample('expect <synthStack> to count resources - more than expected', () => {
    const resourceType = 'Test::Resource';
    const synthStack = synthesizedStack(stack => {
        new TestResource(stack, 'R1', { type: resourceType });
        new TestResource(stack, 'R2', { type: resourceType });
    });
    index_1.expect(synthStack).to(index_1.countResources(resourceType, 1));
});
failingExample('expect <synthStack> to count resources - less than expected', () => {
    const resourceType = 'Test::Resource';
    const synthStack = synthesizedStack(stack => {
        new TestResource(stack, 'R1', { type: resourceType });
        new TestResource(stack, 'R2', { type: resourceType });
    });
    index_1.expect(synthStack).to(index_1.countResources(resourceType, 0));
});
function passingExample(title, cb) {
    if (!exports.passing) {
        exports.passing = {};
    }
    exports.passing[title] = (test) => {
        cb(test);
        test.done();
    };
}
function failingExample(title, cb) {
    if (!exports.failing) {
        exports.failing = {};
    }
    exports.failing[title] = (test) => {
        test.throws(() => {
            cb(test);
        });
        test.done();
    };
}
function synthesizedStack(fn) {
    const app = new cdk.App();
    const stack = new cdk.Stack(app, 'TestStack');
    fn(stack);
    const assembly = app.synth();
    return assembly.getStackArtifact(stack.artifactId);
}
class TestResource extends cdk.CfnResource {
    constructor(scope, id, props) {
        super(scope, id, props);
    }
}
class TestParameter extends cdk.CfnParameter {
    constructor(scope, id, props) {
        super(scope, id, props);
    }
}
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoidGVzdC5hc3NlcnRpb25zLmpzIiwic291cmNlUm9vdCI6IiIsInNvdXJjZXMiOlsidGVzdC5hc3NlcnRpb25zLnRzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiI7O0FBQUEsdUNBQXFDO0FBRXJDLHFDQUFzQztBQUl0Qyx3Q0FBc0M7QUFDdEMsd0NBQWtHO0FBRWxHLGNBQWMsQ0FBQyx3REFBd0QsRUFBRSxHQUFHLEVBQUU7SUFDNUUsTUFBTSxZQUFZLEdBQUcsZ0JBQWdCLENBQUM7SUFDdEMsTUFBTSxVQUFVLEdBQUcsZ0JBQWdCLENBQUMsS0FBSyxDQUFDLEVBQUU7UUFDMUMsSUFBSSxZQUFZLENBQUMsS0FBSyxFQUFFLGNBQWMsRUFBRSxFQUFFLElBQUksRUFBRSxZQUFZLEVBQUUsQ0FBQyxDQUFDO0lBQ2xFLENBQUMsQ0FBQyxDQUFDO0lBQ0gsY0FBTSxDQUFDLFVBQVUsQ0FBQyxDQUFDLEVBQUUsQ0FBQyxlQUFlLENBQUMsQ0FBQyxFQUFFLENBQUMsZ0JBQVEsQ0FBQyxZQUFZLENBQUMsQ0FBQyxDQUFDO0FBQ3BFLENBQUMsQ0FBQyxDQUFDO0FBQ0gsY0FBYyxDQUFDLGlFQUFpRSxFQUFFLEdBQUcsRUFBRTtJQUNyRixNQUFNLFlBQVksR0FBRyxnQkFBZ0IsQ0FBQztJQUN0QyxNQUFNLEtBQUssR0FBRyxJQUFJLEdBQUcsQ0FBQyxLQUFLLEVBQUUsQ0FBQztJQUM5QixJQUFJLFlBQVksQ0FBQyxLQUFLLEVBQUUsY0FBYyxFQUFFLEVBQUUsSUFBSSxFQUFFLFlBQVksRUFBRSxDQUFDLENBQUM7SUFDaEUsY0FBTSxDQUFDLEtBQUssQ0FBQyxDQUFDLEVBQUUsQ0FBQyxlQUFlLENBQUMsQ0FBQyxFQUFFLENBQUMsZ0JBQVEsQ0FBQyxZQUFZLENBQUMsQ0FBQyxDQUFDO0FBQy9ELENBQUMsQ0FBQyxDQUFDO0FBQ0gsY0FBYyxDQUFDLDhEQUE4RCxFQUFFLEdBQUcsRUFBRTtJQUNsRixNQUFNLFlBQVksR0FBRyxnQkFBZ0IsQ0FBQztJQUN0QyxNQUFNLFVBQVUs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LXN1cHBvcnQvcmVnaXN0ZXInO1xuXG5pbXBvcnQgY2RrID0gcmVxdWlyZSgnQGF3cy1jZGsvY29yZScpO1xuaW1wb3J0IGN4ID0gcmVxdWlyZSgnQGF3cy1jZGsvY3gtYXBpJyk7XG5pbXBvcnQgeyBUZXN0IH0gZnJvbSAnbm9kZXVuaXQnO1xuXG5pbXBvcnQgeyBTdGFjayB9IGZyb20gJ0Bhd3MtY2RrL2NvcmUnO1xuaW1wb3J0IHsgY291bnRSZXNvdXJjZXMsIGV4aXN0LCBleHBlY3QsIGhhdmVUeXBlLCBNYXRjaFN0eWxlLCBtYXRjaFRlbXBsYXRlIH0gZnJvbSAnLi4vbGliL2luZGV4JztcblxucGFzc2luZ0V4YW1wbGUoJ2V4cGVjdCA8c3ludGhTdGFjaz4gYXQgPHNvbWUgcGF0aD4gdG8gaGF2ZSA8c29tZSB0eXBlPicsICgpID0+IHtcbiAgY29uc3QgcmVzb3VyY2VUeXBlID0gJ1Rlc3Q6OlJlc291cmNlJztcbiAgY29uc3Qgc3ludGhTdGFjayA9IHN5bnRoZXNpemVkU3RhY2soc3RhY2sgPT4ge1xuICAgIG5ldyBUZXN0UmVzb3VyY2Uoc3RhY2ssICdUZXN0UmVzb3VyY2UnLCB7IHR5cGU6IHJlc291cmNlVHlwZSB9KTtcbiAgfSk7XG4gIGV4cGVjdChzeW50aFN0YWNrKS5hdCgnL1Rlc3RSZXNvdXJjZScpLnRvKGhhdmVUeXBlKHJlc291cmNlVHlwZSkpO1xufSk7XG5wYXNzaW5nRXhhbXBsZSgnZXhwZWN0IG5vbi1zeW50aGVzaXplZCBzdGFjayBhdCA8c29tZSBwYXRoPiB0byBoYXZlIDxzb21lIHR5cGU+JywgKCkgPT4ge1xuICBjb25zdCByZXNvdXJjZVR5cGUgPSAnVGVzdDo6UmVzb3VyY2UnO1xuICBjb25zdCBzdGFjayA9IG5ldyBjZGsuU3RhY2soKTtcbiAgbmV3IFRlc3RSZXNvdXJjZShzdGFjaywgJ1Rlc3RSZXNvdXJjZScsIHsgdHlwZTogcmVzb3VyY2VUeXBlIH0pO1xuICBleHBlY3Qoc3RhY2spLmF0KCcvVGVzdFJlc291cmNlJykudG8oaGF2ZVR5cGUocmVzb3VyY2VUeXBlKSk7XG59KTtcbnBhc3NpbmdFeGFtcGxlKCdleHBlY3QgPHN5bnRoU3RhY2s+IGF0IDxzb21lIHBhdGg+ICpub3QqIHRvIGhhdmUgPHNvbWUgdHlwZT4nLCAoKSA9PiB7XG4gIGNvbnN0IHJlc291cmNlVHlwZSA9ICdUZXN0OjpSZXNvdXJjZSc7XG4gIGNvbnN0IHN5bnRoU3RhY2sgPSBzeW50aGVzaXplZFN0YWNrKHN0YWNrID0+IHtcbiAgICBuZXcgVGVzdFJlc291cmNlKHN0YWNrLCAnVGVzdFJlc291cmNlJywgeyB0eXBlOiByZXNvdXJjZVR5cGUgfSk7XG4gIH0pO1xuICBleHBlY3Qoc3ludGhTdGFjaykuYXQoJy9UZXN0UmVzb3VyY2UnKS5ub3RUbyhoYXZlVHlwZSgnRm9vOjpCYXInKSk7XG59KTtcbnBhc3NpbmdFeGFtcGxlKCdleHBlY3QgPHN5bnRoU3RhY2s+IGF0IDxzb21lIHBhdGg+IHRvIGV4aXN0JywgKCkgPT4ge1xuICBjb25zdCByZXNvdXJjZVR5cGUgPSAnVGVzdDo6UmVzb3VyY2UnO1xuICBjb25zdCBzeW50aFN0YWNrID0gc3ludGhlc2l6ZWRTdGFjayhzdGFjayA9PiB7XG4gICAgbmV3IFRlc3RSZXNvdXJjZShzdGFjaywgJ1Rlc3RSZXNvdXJjZScsIHsgdHlwZTogcmVzb3VyY2VUeXBlIH0pO1xuICB9KTtcbiAgZXhwZWN0KHN5bnRoU3RhY2spLmF0KCcvVGVzdFJlc291cmNlJykudG8oZXhpc3QoKSk7XG59KTtcbnBhc3NpbmdFeGFtcGxlKCdleHBlY3QgPHN5bnRoU3RhY2s+IHRvIG1hdGNoIChleGFjdGx5KSA8dGVtcGxhdGU+JywgKCkgPT4ge1xuICBjb25zdCByZXNvdXJjZVR5cGUgPSAnVGVzdDo6UmVzb3VyY2UnO1xuICBjb25zdCBzeW50aFN0YWNrID0gc3ludGhlc2l6ZWRTdGFjayhzdGFjayA9PiB7XG4gICAgbmV3IFRlc3RSZXNvdXJjZShzdGFjaywgJ1Rlc3RSZXNvdXJjZScsIHsgdHlwZTogcmVzb3VyY2VUeXBlIH0pO1xuICB9KTtcbiAgY29uc3QgZXhwZWN0ZWQgPSB7XG4gICAgUmVzb3VyY2VzOiB7XG4gICAgICBUZXN0UmVzb3VyY2U6IHsgVHlwZTogcmVzb3VyY2VUeXBlIH1cbiAgICB9XG4gIH07XG4gIGV4cGVjdChzeW50aFN0YWNrKS50byhtYXRjaFRlbXBsYXRlKGV4cGVjdGVkLCBNYXRjaFN0eWxlLkVYQUNUKSk7XG59KTtcbnBhc3NpbmdFeGFtcGxlKCdleHBlY3QgPHN5bnRoU3RhY2s+IHRvIG1hdGNoIChubyByZXBsYWNlcykgPHRlbXBsYXRlPicsICgpID0+IHtcbiAgY29uc3QgcmVzb3VyY2VUeXBlID0gJ1Rlc3Q6OlJlc291cmNlJztcbiAgY29uc3Qgc3ludGhTdGFjayA9IHN5bnRoZXNpemVkU3RhY2soc3RhY2sgPT4ge1xuICAgIG5ldyBUZXN0UmVzb3VyY2Uoc3RhY2ssICdUZXN0UmVzb3VyY2UnLCB7IHR5cGU6IHJlc291cmNlVHlwZSB9KTtcbiAgfSk7XG4gIGNvbnN0IGV4cGVjdGVkID0ge307XG4gIGV4cGVjdChzeW50aFN0YWNrKS50byhtYXRjaFRlbXBsYXRlKGV4cGVjdGVkLCBNYXRjaFN0eWxlLk5PX1JFUExBQ0VTKSk7XG59KTtcbnBhc3NpbmdFeGFtcGxlKCdleHBlY3QgPHN5bnRoU3RhY2s+IHRvIGJlIGEgc3VwZXJzZXQgb2YgPHRlbXBsYXRlPicsICgpID0+IHtcbiAgY29uc3QgcmVzb3VyY2VUeXBlID0gJ1Rlc3Q6OlJlc291cmNlJztcbiAgY29uc3Qgc3ludGhTdGFjayA9IHN5bnRoZXNpemVkU3RhY2soc3RhY2sgPT4ge1xuICAgIC8vIEFkZGVkXG4gICAgbmV3IFRlc3RSZXNvdXJjZShzdGFjaywgJ05ld1Jlc291cmNlJywgeyB0eXBlOiAnQVdTOjpTMzo6QnVja2V0JyB9KTtcbiAgICAvLyBFeHBlY3RlZFxuICAgIG5ldyBUZXN0UmVzb3VyY2Uoc3RhY2ssICdUZXN0UmVzb3VyY2VBJywgeyB0eXBlOiByZXNvdXJjZVR5cGUgfSk7XG4gICAgbmV3IFRlc3RSZXNvdXJjZShzdGFjaywgJ1Rlc3RSZXNvdXJjZUInLCB7IHR5cGU6IHJlc291cmNlVHlwZSwgcHJvcGVydGllczogeyBGb286ICdCYXInIH0gfSk7XG4gIH0pO1xuICBjb25zdCBleHBlY3RlZCA9IHtcbiAgICBSZXNvdXJjZXM6IHtcbiAgICAgIFRlc3RSZXNvdXJjZUE6IHsgVHlwZTogJ1Rlc3Q6OlJlc291cmNlJyB9LFxuICAgICAgVGVzdFJlc291cmNlQjogeyBUeXBlOiAnVGVzdDo6UmVzb3VyY2UnLCBQcm9wZXJ0aWVzOiB7IEZvbzogJ0JhcicgfSB9XG4gICAgfVxuICB9O1xuICBleHBlY3Qoc3ludGhTdGFjaykudG8obWF0Y2hUZW1wbGF0ZShleHBlY3RlZCwgTWF0Y2hTdHlsZS5TVVBFUlNFVCkpO1xufSk7XG5wYXNzaW5nRXhhbXBsZSgnc3VnYXIgZm9yIG1hdGNoaW5nIHN0YWNrIHRvIGEgdGVtcGxhdGUnLCAoKSA9PiB7XG4gIGNvbnN0IHN0YWNrID0gbmV3IFN0YWNrKCk7XG4gIG5ldyBUZXN0UmVzb3VyY2Uoc3RhY2ssICdUZXN0UmVzb3VyY2UnLCB7IHR5cGU6ICdUZXN0OjpSZXNvdXJjZScgfSk7XG4gIGV4cGVjdChzdGFjaykudG9NYXRjaCh7XG4gICAgUmVzb3VyY2VzOiB7XG4gICAgICBUZXN0UmVzb3VyY2U6IHtcbiAgICAgICAgVHlwZTogJ1Rlc3Q6OlJlc291cmNlJ1xuICAgICAgfVxuICAgIH1cbiAgfSk7XG59KTtcbnBhc3NpbmdFeGFtcGxlKCdleHBlY3QgPHN5bnRoU3RhY2s+IHRvIG1hdGNoIChubyByZXBsYWNlcykgPHRlbXBsYXRlPiB3aXRoIHBhcmFtZXRlcnMnLCAoKSA9PiB7XG4gIGNvbnN0IHBhcmFtZXRlclR5cGUgPSAnVGVzdDo6UGFyYW1ldGVyJztcbiAgY29uc3Qgc3ludGhTdGFjayA9IHN5bnRoZXNpemVkU3RhY2soc3RhY2sgPT4ge1xuICAgIG5ldyBUZXN0UGFyYW1ldGVyKHN0YWNrLCAnVGVzdFBhcmFtZXRlcicsIHsgdHlwZTogcGFyYW1ldGVyVHlwZSB9KTtcbiAgfSk7XG4gIGNvbnN0IGV4cGVjdGVkID0ge307XG4gIGV4cGVjdChzeW50aFN0YWNrKS50byhtYXRjaFRlbXBsYXRlKGV4cGVjdGVkLCBNYXRjaFN0eWxlLk5PX1JFUExBQ0VTKSk7XG59KTtcbnBhc3NpbmdFeGFtcGxlKCdleHBlY3QgPHN5bnRoU3RhY2s+IHRvIGJlIGEgc3VwZXJzZXQgb2YgPHRlbXBsYXRlPiB3aXRoIHBhcmFtZXRlcnMnLCAoKSA9PiB7XG4gIGNvbnN0IHBhcmFtZXRlclR5cGUgPSAnVGVzdDo6UGFyYW1ldGVyJztcbiAgY29uc3Qgc3ludGhTdGFjayA9IHN5bnRoZXNpemVkU3RhY2soc3RhY2sgPT4ge1xuICAgIC8vIEFkZGVkXG4gICAgbmV3IFRlc3RSZXNvdXJjZShzdGFjaywgJ05ld1Jlc291cmNlJywgeyB0eXBlOiAnQVdTOjpTMzo6QnVja2V0JyB9KTtcbiAgICAvLyBFeHBlY3RlZFxuICAgIG5ldyBUZXN0UGFyYW1ldGVyKHN0YWNrLCAnVGVzdFBhcmFtZXRlckEnLCB7dHlwZTogcGFyYW1ldGVyVHlwZX0pO1xuICAgIG5ldyBUZXN0UGFyYW1ldGVyKHN0YWNrLCAnVGVzdFBhcmFtZXRlckInLCB7dHlwZTogcGFyYW1ldGVyVHlwZSwgZGVmYXVsdDogeyBGb286ICdCYXInIH0gfSk7XG4gIH0pO1xuICBjb25zdCBleHBlY3RlZCA9IHtcbiAgICBQYXJhbWV0ZXJzOiB7XG4gICAgICBUZXN0UGFyYW1ldGVyQTogeyBUeXBlOiAnVGVzdDo6UGFyYW1ldGVyJyB9LFxuICAgICAgVGVzdFBhcmFtZXRlckI6IHsgVHlwZTogJ1Rlc3Q6OlBhcmFtZXRlcicsIERlZmF1bHQ6IHsgRm9vOiAnQmFyJyB9IH1cbiAgICB9XG4gIH07XG4gIGV4cGVjdChzeW50aFN0YWNrKS50byhtYXRjaFRlbXBsYXRlKGV4cGVjdGVkLCBNYXRjaFN0eWxlLlNVUEVSU0VUKSk7XG59KTtcblxuZmFpbGluZ0V4YW1wbGUoJ2V4cGVjdCA8c3ludGhTdGFjaz4gYXQgPHNvbWUgcGF0aD4gKm5vdCogdG8gaGF2ZSA8c29tZSB0eXBlPicsICgpID0+IHtcbiAgY29uc3QgcmVzb3VyY2VUeXBlID0gJ1Rlc3Q6OlJlc291cmNlJztcbiAgY29uc3Qgc3ludGhTdGFjayA9IHN5bnRoZXNpemVkU3RhY2soc3RhY2sgPT4ge1xuICAgIG5ldyBUZXN0UmVzb3VyY2Uoc3RhY2ssICdUZXN0UmVzb3VyY2UnLCB7IHR5cGU6IHJlc291cmNlVHlwZSB9KTtcbiAgfSk7XG4gIGV4cGVjdChzeW50aFN0YWNrKS5hdCgnL1Rlc3RSZXNvdXJjZScpLm5vdFRvKGhhdmVUeXBlKHJlc291cmNlVHlwZSkpO1xufSk7XG5mYWlsaW5nRXhhbXBsZSgnZXhwZWN0IDxzeW50aFN0YWNrPiBhdCA8c29tZSBwYXRoPiB0byBoYXZlIDxzb21lIHR5cGU+JywgKCkgPT4ge1xuICBjb25zdCByZXNvdXJjZVR5cGUgPSAnVGVzdDo6UmVzb3VyY2UnO1xuICBjb25zdCBzeW50aFN0YWNrID0gc3ludGhlc2l6ZWRTdGFjayhzdGFjayA9PiB7XG4gICAgbmV3IFRlc3RSZXNvdXJjZShzdGFjaywgJ1Rlc3RSZXNvdXJjZScsIHsgdHlwZTogcmVzb3VyY2VUeXBlIH0pO1xuICB9KTtcbiAgZXhwZWN0KHN5bnRoU3RhY2spLmF0KCcvVGVzdFJlc291cmNlJykudG8oaGF2ZVR5cGUoJ0Zvbzo6QmFyJykpO1xufSk7XG5mYWlsaW5nRXhhbXBsZSgnZXhwZWN0IDxzeW50aFN0YWNrPiBhdCA8c29tZSBwYXRoPiB0byBleGlzdCcsICgpID0+IHtcbiAgY29uc3QgcmVzb3VyY2VUeXBlID0gJ1Rlc3Q6OlJlc291cmNlJztcbiAgY29uc3Qgc3ludGhTdGFjayA9IHN5bnRoZXNpemVkU3RhY2soc3RhY2sgPT4ge1xuICAgIG5ldyBUZXN0UmVzb3VyY2Uoc3RhY2ssICdUZXN0UmVzb3VyY2UnLCB7IHR5cGU6IHJlc291cmNlVHlwZSB9KTtcbiAgfSk7XG4gIGV4cGVjdChzeW50aFN0YWNrKS5hdCgnL0Zvby9CYXInKS50byhleGlzdCgpKTtcbn0pO1xuZmFpbGluZ0V4YW1wbGUoJ2V4cGVjdCA8c3ludGhTdGFjaz4gdG8gbWF0Y2ggKGV4YWN0bHkpIDx0ZW1wbGF0ZT4nLCAoKSA9PiB7XG4gIGNvbnN0IHJlc291cmNlVHlwZSA9ICdUZXN0OjpSZXNvdXJjZSc7XG4gIGNvbnN0IHN5bnRoU3RhY2sgPSBzeW50aGVzaXplZFN0YWNrKHN0YWNrID0+IHtcbiAgICBuZXcgVGVzdFJlc291cmNlKHN0YWNrLCAnVGVzdFJlc291cmNlJywgeyB0eXBlOiByZXNvdXJjZVR5cGUgfSk7XG4gIH0pO1xuICBjb25zdCBleHBlY3RlZCA9IHtcbiAgICBSZXNvdXJjZXM6IHtcbiAgICAgIFRlc3RSZXNvdXJjZTogeyBUeXBlOiByZXNvdXJjZVR5cGUsIERlcGVuZHNPbjogWydTb21ldGhpbmcnXSB9XG4gICAgfVxuICB9O1xuICBleHBlY3Qoc3ludGhTdGFjaykudG8obWF0Y2hUZW1wbGF0ZShleHBlY3RlZCwgTWF0Y2hTdHlsZS5FWEFDVCkpO1xufSk7XG5mYWlsaW5nRXhhbXBsZSgnZXhwZWN0IDxzeW50aFN0YWNrPiB0byBtYXRjaCAobm8gcmVwbGFjZXMpIDx0ZW1wbGF0ZT4nLCAoKSA9PiB7XG4gIGNvbnN0IHJlc291cmNlVHlwZSA9ICdUZXN0OjpSZXNvdXJjZSc7XG4gIGNvbnN0IHN5bnRoU3RhY2sgPSBzeW50aGVzaXplZFN0YWNrKHN0YWNrID0+IHtcbiAgICBuZXcgVGVzdFJlc291cmNlKHN0YWNrLCAnVGVzdFJlc291cmNlJywgeyB0eXBlOiByZXNvdXJjZVR5cGUgfSk7XG4gIH0pO1xuICBjb25zdCBleHBlY3RlZCA9IHtcbiAgICBSZXNvdXJjZXM6IHtcbiAgICAgIFRlc3RSZXNvdXJjZTogeyBUeXBlOiAnQVdTOjpTMzo6QnVja2V0JyB9XG4gICAgfVxuICB9O1xuICBleHBlY3Qoc3ludGhTdGFjaykudG8obWF0Y2hUZW1wbGF0ZShleHBlY3RlZCwgTWF0Y2hTdHlsZS5OT19SRVBMQUNFUykpO1xufSk7XG5mYWlsaW5nRXhhbXBsZSgnZXhwZWN0IDxzeW50aFN0YWNrPiB0byBiZSBhIHN1cGVyc2V0IG9mIDx0ZW1wbGF0ZT4nLCAoKSA9PiB7XG4gIGNvbnN0IHJlc291cmNlVHlwZSA9ICdUZXN0OjpSZXNvdXJjZSc7XG4gIGNvbnN0IHN5bnRoU3RhY2sgPSBzeW50aGVzaXplZFN0YWNrKHN0YWNrID0+IHtcbiAgICAvLyBBZGRlZFxuICAgIG5ldyBUZXN0UmVzb3VyY2Uoc3RhY2ssICdOZXdSZXNvdXJjZScsIHsgdHlwZTogJ0FXUzo6UzM6OkJ1Y2tldCcgfSk7XG4gICAgLy8gRXhwZWN0ZWRcbiAgICBuZXcgVGVzdFJlc291cmNlKHN0YWNrLCAnVGVzdFJlc291cmNlQScsIHsgdHlwZTogcmVzb3VyY2VUeXBlIH0pO1xuICAgIC8vIEV4cGVjdGVkLCBidXQgaGFzIGRpZmZlcmVudCBwcm9wZXJ0aWVzIC0gd2lsbCBicmVha1xuICAgIG5ldyBUZXN0UmVzb3VyY2Uoc3RhY2ssICdUZXN0UmVzb3VyY2VCJywgeyB0eXBlOiByZXNvdXJjZVR5cGUsIHByb3BlcnRpZXM6IHsgRm9vOiAnQmFyJyB9IH0pO1xuICB9KTtcbiAgY29uc3QgZXhwZWN0ZWQgPSB7XG4gICAgUmVzb3VyY2VzOiB7XG4gICAgICBUZXN0UmVzb3VyY2VBOiB7IFR5cGU6ICdUZXN0OjpSZXNvdXJjZScgfSxcbiAgICAgIFRlc3RSZXNvdXJjZUI6IHsgVHlwZTogJ1Rlc3Q6OlJlc291cmNlJywgUHJvcGVydGllczogeyBGb286ICdCYXonIH0gfVxuICAgIH1cbiAgfTtcbiAgZXhwZWN0KHN5bnRoU3RhY2spLnRvKG1hdGNoVGVtcGxhdGUoZXhwZWN0ZWQsIE1hdGNoU3R5bGUuU1VQRVJTRVQpKTtcbn0pO1xuZmFpbGluZ0V4YW1wbGUoJ2V4cGVjdCA8c3ludGhTdGFjaz4gdG8gbWF0Y2ggKG5vIHJlcGxhY2VzKSA8dGVtcGxhdGU+IHdpdGggcGFyYW1ldGVycycsICgpID0+IHtcbiAgY29uc3QgcGFyYW1ldGVyVHlwZSA9ICdUZXN0OjpQYXJhbWV0ZXInO1xuICBjb25zdCBzeW50aFN0YWNrID0gc3ludGhlc2l6ZWRTdGFjayhzdGFjayA9PiB7XG4gICAgbmV3IFRlc3RQYXJhbWV0ZXIoc3RhY2ssICdUZXN0UGFyYW1ldGVyJywgeyB0eXBlOiBwYXJhbWV0ZXJUeXBlIH0pO1xuICB9KTtcbiAgY29uc3QgZXhwZWN0ZWQgPSB7XG4gICAgUGFyYW1ldGVyczoge1xuICAgICAgVGVzdFBhcmFtZXRlcjogeyBUeXBlOiAnQVdTOjpTMzo6QnVja2V0JyB9XG4gICAgfVxuICB9O1xuICBleHBlY3Qoc3ludGhTdGFjaykudG8obWF0Y2hUZW1wbGF0ZShleHBlY3RlZCwgTWF0Y2hTdHlsZS5OT19SRVBMQUNFUykpO1xufSk7XG5mYWlsaW5nRXhhbXBsZSgnZXhwZWN0IDxzeW50aFN0YWNrPiB0byBiZSBhIHN1cGVyc2V0IG9mIDx0ZW1wbGF0ZT4gd2l0aCBwYXJhbWV0ZXJzJywgKCkgPT4ge1xuICBjb25zdCBwYXJhbWV0ZXJUeXBlID0gJ1Rlc3Q6OlBhcmFtZXRlcic7XG4gIGNvbnN0IHN5bnRoU3RhY2sgPSBzeW50aGVzaXplZFN0YWNrKHN0YWNrID0+IHtcbiAgICAvLyBBZGRlZFxuICAgIG5ldyBUZXN0UGFyYW1ldGVyKHN0YWNrLCAnTmV3UGFyYW1ldGVyJywgeyB0eXBlOiAnQVdTOjpTMzo6QnVja2V0JyB9KTtcbiAgICAvLyBFeHBlY3RlZFxuICAgIG5ldyBUZXN0UGFyYW1ldGVyKHN0YWNrLCAnVGVzdFBhcmFtZXRlckEnLCB7IHR5cGU6IHBhcmFtZXRlclR5cGUgfSk7XG4gICAgLy8gRXhwZWN0ZWQsIGJ1dCBoYXMgZGlmZmVyZW50IHByb3BlcnRpZXMgLSB3aWxsIGJyZWFrXG4gICAgbmV3IFRlc3RQYXJhbWV0ZXIoc3RhY2ssICdUZXN0UGFyYW1ldGVyQicsIHsgdHlwZTogcGFyYW1ldGVyVHlwZSwgZGVmYXVsdDogeyBGb286ICdCYXInIH0gfSk7XG4gIH0pO1xuICBjb25zdCBleHBlY3RlZCA9IHtcbiAgICBQYXJhbWV0ZXJzOiB7XG4gICAgICBUZXN0UGFyYW1ldGVyQTogeyBUeXBlOiAnVGVzdDo6UGFyYW1ldGVyJyB9LFxuICAgICAgVGVzdFBhcmFtZXRlckI6IHsgVHlwZTogJ1Rlc3Q6OlBhcmFtZXRlcicsIERlZmF1bHQ6IHsgRm9vOiAnQmF6JyB9IH1cbiAgICB9XG4gIH07XG4gIGV4cGVjdChzeW50aFN0YWNrKS50byhtYXRjaFRlbXBsYXRlKGV4cGVjdGVkLCBNYXRjaFN0eWxlLlNVUEVSU0VUKSk7XG59KTtcblxuLy8gY291bnRSZXNvdXJjZXNcblxucGFzc2luZ0V4YW1wbGUoJ2V4cGVjdCA8c3ludGhTdGFjaz4gdG8gY291bnQgcmVzb3VyY2VzIC0gYXMgZXhwZWN0ZWQnLCAoKSA9PiB7XG4gIGNvbnN0IHN5bnRoU3RhY2sgPSBzeW50aGVzaXplZFN0YWNrKHN0YWNrID0+IHtcbiAgICBuZXcgVGVzdFJlc291cmNlKHN0YWNrLCAnUjEnLCB7IHR5cGU6ICdCYXInIH0pO1xuICAgIG5ldyBUZXN0UmVzb3VyY2Uoc3RhY2ssICdSMicsIHsgdHlwZTogJ0JhcicgfSk7XG4gICAgbmV3IFRlc3RSZXNvdXJjZShzdGFjaywgJ1IzJywgeyB0eXBlOiAnRm9vJyB9KTtcbiAgfSk7XG5cbiAgZXhwZWN0KHN5bnRoU3RhY2spLnRvKGNvdW50UmVzb3VyY2VzKCdCYXInLCAyKSk7XG4gIGV4cGVjdChzeW50aFN0YWNrKS50byhjb3VudFJlc291cmNlcygnRm9vJywgMSkpO1xufSk7XG5cbnBhc3NpbmdFeGFtcGxlKCdleHBlY3QgPHN0YWNrPiB0byBjb3VudCByZXNvdXJjZXMgLSBleHBlY3RlZCBubyByZXNvdXJjZXMnLCAoKSA9PiB7XG4gIGNvbnN0IHJlc291cmNlVHlwZSA9ICdUZXN0OjpSZXNvdXJjZSc7XG4gIGNvbnN0IHN0YWNrID0gbmV3IFN0YWNrKCk7XG4gIGV4cGVjdChzdGFjaykudG8oY291bnRSZXNvdXJjZXMocmVzb3VyY2VUeXBlLCAwKSk7XG59KTtcblxuZmFpbGluZ0V4YW1wbGUoJ2V4cGVjdCA8c3ludGhTdGFjaz4gdG8gY291bnQgcmVzb3VyY2VzIC0gbW9yZSB0aGFuIGV4cGVjdGVkJywgKCkgPT4ge1xuICBjb25zdCByZXNvdXJjZVR5cGUgPSAnVGVzdDo6UmVzb3VyY2UnO1xuICBjb25zdCBzeW50aFN0YWNrID0gc3ludGhlc2l6ZWRTdGFjayhzdGFjayA9PiB7XG4gICAgbmV3IFRlc3RSZXNvdXJjZShzdGFjaywgJ1IxJywgeyB0eXBlOiByZXNvdXJjZVR5cGUgfSk7XG4gICAgbmV3IFRlc3RSZXNvdXJjZShzdGFjaywgJ1IyJywgeyB0eXBlOiByZXNvdXJjZVR5cGUgfSk7XG4gIH0pO1xuXG4gIGV4cGVjdChzeW50aFN0YWNrKS50byhjb3VudFJlc291cmNlcyhyZXNvdXJjZVR5cGUsIDEpKTtcbn0pO1xuXG5mYWlsaW5nRXhhbXBsZSgnZXhwZWN0IDxzeW50aFN0YWNrPiB0byBjb3VudCByZXNvdXJjZXMgLSBsZXNzIHRoYW4gZXhwZWN0ZWQnLCAoKSA9PiB7XG4gIGNvbnN0IHJlc291cmNlVHlwZSA9ICdUZXN0OjpSZXNvdXJjZSc7XG4gIGNvbnN0IHN5bnRoU3RhY2sgPSBzeW50aGVzaXplZFN0YWNrKHN0YWNrID0+IHtcbiAgICBuZXcgVGVzdFJlc291cmNlKHN0YWNrLCAnUjEnLCB7IHR5cGU6IHJlc291cmNlVHlwZSB9KTtcbiAgICBuZXcgVGVzdFJlc291cmNlKHN0YWNrLCAnUjInLCB7IHR5cGU6IHJlc291cmNlVHlwZSB9KTtcbiAgfSk7XG5cbiAgZXhwZWN0KHN5bnRoU3RhY2spLnRvKGNvdW50UmVzb3VyY2VzKHJlc291cmNlVHlwZSwgMCkpO1xufSk7XG5cbmZ1bmN0aW9uIHBhc3NpbmdFeGFtcGxlKHRpdGxlOiBzdHJpbmcsIGNiOiAodGVzdDogVGVzdCkgPT4gdm9pZCkge1xuICBpZiAoIWV4cG9ydHMucGFzc2luZykgeyBleHBvcnRzLnBhc3NpbmcgPSB7fTsgfVxuICBleHBvcnRzLnBhc3NpbmdbdGl0bGVdID0gKHRlc3Q6IFRlc3QpID0+IHtcbiAgICBjYih0ZXN0KTtcbiAgICB0ZXN0LmRvbmUoKTtcbiAgfTtcbn1cblxuZnVuY3Rpb24gZmFpbGluZ0V4YW1wbGUodGl0bGU6IHN0cmluZywgY2I6ICh0ZXN0OiBUZXN0KSA9PiB2b2lkKSB7XG4gIGlmICghZXhwb3J0cy5mYWlsaW5nKSB7IGV4cG9ydHMuZmFpbGluZyA9IHt9OyB9XG4gIGV4cG9ydHMuZmFpbGluZ1t0aXRsZV0gPSAodGVzdDogVGVzdCkgPT4ge1xuICAgIHRlc3QudGhyb3dzKCgpID0+IHtcbiAgICAgIGNiKHRlc3QpO1xuICAgIH0pO1xuICAgIHRlc3QuZG9uZSgpO1xuICB9O1xufVxuXG5mdW5jdGlvbiBzeW50aGVzaXplZFN0YWNrKGZuOiAoc3RhY2s6IGNkay5TdGFjaykgPT4gdm9pZCk6IGN4LkNsb3VkRm9ybWF0aW9uU3RhY2tBcnRpZmFjdCB7XG4gIGNvbnN0IGFwcCA9IG5ldyBjZGsuQXBwKCk7XG4gIGNvbnN0IHN0YWNrID0gbmV3IGNkay5TdGFjayhhcHAsICdUZXN0U3RhY2snKTtcbiAgZm4oc3RhY2spO1xuXG4gIGNvbnN0IGFzc2VtYmx5ID0gYXBwLnN5bnRoKCk7XG4gIHJldHVybiBhc3NlbWJseS5nZXRTdGFja0FydGlmYWN0KHN0YWNrLmFydGlmYWN0SWQpO1xufVxuXG5pbnRlcmZhY2UgVGVzdFJlc291cmNlUHJvcHMgZXh0ZW5kcyBjZGsuQ2ZuUmVzb3VyY2VQcm9wcyB7XG4gIHR5cGU6IHN0cmluZztcbn1cblxuY2xhc3MgVGVzdFJlc291cmNlIGV4dGVuZHMgY2RrLkNmblJlc291cmNlIHtcbiAgY29uc3RydWN0b3Ioc2NvcGU6IGNkay5Db25zdHJ1Y3QsIGlkOiBzdHJpbmcsIHByb3BzOiBUZXN0UmVzb3VyY2VQcm9wcykge1xuICAgIHN1cGVyKHNjb3BlLCBpZCwgcHJvcHMpO1xuICB9XG59XG5cbmludGVyZmFjZSBUZXN0UGFyYW1ldGVyUHJvcHMgZXh0ZW5kcyBjZGsuQ2ZuUGFyYW1ldGVyUHJvcHMge1xuICB0eXBlOiBzdHJpbmc7XG59XG5cbmNsYXNzIFRlc3RQYXJhbWV0ZXIgZXh0ZW5kcyBjZGsuQ2ZuUGFyYW1ldGVyIHtcbiAgY29uc3RydWN0b3Ioc2NvcGU6IGNkay5Db25zdHJ1Y3QsIGlkOiBzdHJpbmcsIHByb3BzOiBUZXN0UGFyYW1ldGVyUHJvcHMpIHtcbiAgICBzdXBlcihzY29wZSwgaWQsIHByb3BzKTtcbiAgfVxufVxuIl19