"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
/// !cdk-integ *
const sns = require("@aws-cdk/aws-sns");
const core_1 = require("@aws-cdk/core");
const cfn = require("../lib");
// non-nested non-parent stack consumes a resource from a nested stack
class ProducerNestedStack extends cfn.NestedStack {
    constructor(scope, id) {
        super(scope, id);
        this.topic = new sns.Topic(this, 'MyTopic');
    }
}
class ParentStack extends core_1.Stack {
    constructor(scope, id) {
        super(scope, id);
        const nested = new ProducerNestedStack(this, 'Nested1');
        this.topic = nested.topic;
    }
}
class ConsumerStack extends core_1.Stack {
    constructor(scope, id, topic) {
        super(scope, id);
        new sns.Topic(this, 'ConsumerTopic', {
            displayName: `Consuming ${core_1.Fn.select(2, core_1.Fn.split('-', topic.topicName))}` // just shorten because display name is limited
        });
    }
}
const app = new core_1.App();
const parent = new ParentStack(app, 'nested-stacks-refs2-parent-with-producer');
new ConsumerStack(app, 'nested-stacks-refs2-consumer', parent.topic);
app.synth();
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiaW50ZWcubmVzdGVkLXN0YWNrcy1yZWZzMi5qcyIsInNvdXJjZVJvb3QiOiIiLCJzb3VyY2VzIjpbImludGVnLm5lc3RlZC1zdGFja3MtcmVmczIudHMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6Ijs7QUFBQSxnQkFBZ0I7QUFDaEIsd0NBQXlDO0FBQ3pDLHdDQUEwRDtBQUMxRCw4QkFBK0I7QUFFL0Isc0VBQXNFO0FBRXRFLE1BQU0sbUJBQW9CLFNBQVEsR0FBRyxDQUFDLFdBQVc7SUFHL0MsWUFBWSxLQUFnQixFQUFFLEVBQVU7UUFDdEMsS0FBSyxDQUFDLEtBQUssRUFBRSxFQUFFLENBQUMsQ0FBQztRQUVqQixJQUFJLENBQUMsS0FBSyxHQUFHLElBQUksR0FBRyxDQUFDLEtBQUssQ0FBQyxJQUFJLEVBQUUsU0FBUyxDQUFDLENBQUM7SUFDOUMsQ0FBQztDQUNGO0FBRUQsTUFBTSxXQUFZLFNBQVEsWUFBSztJQUc3QixZQUFZLEtBQWdCLEVBQUUsRUFBVTtRQUN0QyxLQUFLLENBQUMsS0FBSyxFQUFFLEVBQUUsQ0FBQyxDQUFDO1FBRWpCLE1BQU0sTUFBTSxHQUFHLElBQUksbUJBQW1CLENBQUMsSUFBSSxFQUFFLFNBQVMsQ0FBQyxDQUFDO1FBQ3hELElBQUksQ0FBQyxLQUFLLEdBQUcsTUFBTSxDQUFDLEtBQUssQ0FBQztJQUM1QixDQUFDO0NBQ0Y7QUFFRCxNQUFNLGFBQWMsU0FBUSxZQUFLO0lBQy9CLFlBQVksS0FBZ0IsRUFBRSxFQUFVLEVBQUUsS0FBZ0I7UUFDeEQsS0FBSyxDQUFDLEtBQUssRUFBRSxFQUFFLENBQUMsQ0FBQztRQUVqQixJQUFJLEdBQUcsQ0FBQyxLQUFLLENBQUMsSUFBSSxFQUFFLGVBQWUsRUFBRTtZQUNuQyxXQUFXLEVBQUUsYUFBYSxTQUFFLENBQUMsTUFBTSxDQUFDLENBQUMsRUFBRSxTQUFFLENBQUMsS0FBSyxDQUFDLEdBQUcsRUFBRSxLQUFLLENBQUMsU0FBUyxDQUFDLENBQUMsRUFBRSxDQUFDLCtDQUErQztTQUN6SCxDQUFDLENBQUM7SUFDTCxDQUFDO0NBQ0Y7QUFFRCxNQUFNLEdBQUcsR0FBRyxJQUFJLFVBQUcsRUFBRSxDQUFDO0FBQ3RCLE1BQU0sTUFBTSxHQUFHLElBQUksV0FBVyxDQUFDLEdBQUcsRUFBRSwwQ0FBMEMsQ0FBQyxDQUFDO0FBQ2hGLElBQUksYUFBYSxDQUFDLEdBQUcsRUFBRSw4QkFBOEIsRUFBRSxNQUFNLENBQUMsS0FBSyxDQUFDLENBQUM7QUFDckUsR0FBRyxDQUFDLEtBQUssRUFBRSxDQUFDIiwic291cmNlc0NvbnRlbnQiOlsiLy8vICFjZGstaW50ZWcgKlxuaW1wb3J0IHNucyA9IHJlcXVpcmUoJ0Bhd3MtY2RrL2F3cy1zbnMnKTtcbmltcG9ydCB7IEFwcCwgQ29uc3RydWN0LCBGbiwgU3RhY2sgfSBmcm9tICdAYXdzLWNkay9jb3JlJztcbmltcG9ydCBjZm4gPSByZXF1aXJlKCcuLi9saWInKTtcblxuLy8gbm9uLW5lc3RlZCBub24tcGFyZW50IHN0YWNrIGNvbnN1bWVzIGEgcmVzb3VyY2UgZnJvbSBhIG5lc3RlZCBzdGFja1xuXG5jbGFzcyBQcm9kdWNlck5lc3RlZFN0YWNrIGV4dGVuZHMgY2ZuLk5lc3RlZFN0YWNrIHtcbiAgcHVibGljIHJlYWRvbmx5IHRvcGljOiBzbnMuVG9waWM7XG5cbiAgY29uc3RydWN0b3Ioc2NvcGU6IENvbnN0cnVjdCwgaWQ6IHN0cmluZykge1xuICAgIHN1cGVyKHNjb3BlLCBpZCk7XG5cbiAgICB0aGlzLnRvcGljID0gbmV3IHNucy5Ub3BpYyh0aGlzLCAnTXlUb3BpYycpO1xuICB9XG59XG5cbmNsYXNzIFBhcmVudFN0YWNrIGV4dGVuZHMgU3RhY2sge1xuICBwdWJsaWMgcmVhZG9ubHkgdG9waWM6IHNucy5Ub3BpYztcblxuICBjb25zdHJ1Y3RvcihzY29wZTogQ29uc3RydWN0LCBpZDogc3RyaW5nKSB7XG4gICAgc3VwZXIoc2NvcGUsIGlkKTtcblxuICAgIGNvbnN0IG5lc3RlZCA9IG5ldyBQcm9kdWNlck5lc3RlZFN0YWNrKHRoaXMsICdOZXN0ZWQxJyk7XG4gICAgdGhpcy50b3BpYyA9IG5lc3RlZC50b3BpYztcbiAgfVxufVxuXG5jbGFzcyBDb25zdW1lclN0YWNrIGV4dGVuZHMgU3RhY2sge1xuICBjb25zdHJ1Y3RvcihzY29wZTogQ29uc3RydWN0LCBpZDogc3RyaW5nLCB0b3BpYzogc25zLlRvcGljKSB7XG4gICAgc3VwZXIoc2NvcGUsIGlkKTtcblxuICAgIG5ldyBzbnMuVG9waWModGhpcywgJ0NvbnN1bWVyVG9waWMnLCB7XG4gICAgICBkaXNwbGF5TmFtZTogYENvbnN1bWluZyAke0ZuLnNlbGVjdCgyLCBGbi5zcGxpdCgnLScsIHRvcGljLnRvcGljTmFtZSkpfWAgLy8ganVzdCBzaG9ydGVuIGJlY2F1c2UgZGlzcGxheSBuYW1lIGlzIGxpbWl0ZWRcbiAgICB9KTtcbiAgfVxufVxuXG5jb25zdCBhcHAgPSBuZXcgQXBwKCk7XG5jb25zdCBwYXJlbnQgPSBuZXcgUGFyZW50U3RhY2soYXBwLCAnbmVzdGVkLXN0YWNrcy1yZWZzMi1wYXJlbnQtd2l0aC1wcm9kdWNlcicpO1xubmV3IENvbnN1bWVyU3RhY2soYXBwLCAnbmVzdGVkLXN0YWNrcy1yZWZzMi1jb25zdW1lcicsIHBhcmVudC50b3BpYyk7XG5hcHAuc3ludGgoKTsiXX0=